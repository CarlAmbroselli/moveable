{"version":3,"file":"helper.esm.js","sources":["../src/groups.ts","../src/GroupManager.ts"],"sourcesContent":["import { isArray, deepFlat, find } from \"@daybrush/utils\";\nimport { GroupChild, TargetGroupsObject, TargetGroupsType } from \"./types\";\n\nexport class Child {\n    public type: \"group\" | \"root\" | \"single\" = \"single\";\n    public depth = 0;\n    protected _scope: string[] = [];\n    constructor(public parent?: ArrayChild) {\n        if (parent) {\n            this.depth = parent.depth + 1;\n        }\n    }\n\n    public get scope(): string[] {\n        const parent = this.parent;\n\n        if (!parent || parent.type === \"root\") {\n            return [];\n        }\n        return [...parent.scope, parent.id];\n    }\n}\n\nexport class SingleChild extends Child {\n    public type = \"single\" as const;\n    public isGroupElement = false;\n    constructor(parent: ArrayChild, public value: HTMLElement | SVGElement) {\n        super(parent);\n    }\n}\n\n\nexport class ArrayChild extends Child {\n    public type: \"group\" | \"root\" = \"group\";\n    public value: GroupChild[] = [];\n    public id = \"\";\n    public groupElement?: HTMLElement | SVGElement | null = null;\n    public map: Map<HTMLElement | SVGElement, SingleChild> = new Map();\n\n    public compare(groups: TargetGroupsType, checker: -1 | 0 | 1 = 0) {\n        const elements = deepFlat(groups);\n        const map = this.map;\n        const elementsLength = elements.length;\n        const mapSize = map.size;\n        const sizeDiff = mapSize - elementsLength;\n\n        // 1 this > groups\n        // 0 this = groups\n        // -1 this < groups\n        const count = elements.filter(element => map.has(element)).length;\n\n        if ((checker > 0 && sizeDiff >= 0) || (checker === 0 && sizeDiff === 0)) {\n            return elementsLength === count;\n        } else if (checker < 0 && sizeDiff <= 0) {\n            return mapSize === count;\n        }\n        return false;\n    }\n    public has(target: HTMLElement | SVGElement) {\n        return this.map.has(target);\n    }\n    public contains(element: HTMLElement | SVGElement): boolean {\n        if (this.has(element)) {\n            return true;\n        }\n        return this.value.some(child => {\n            if (child.type === \"group\") {\n                return child.contains(element);\n            } else {\n                return false;\n            }\n        });\n    }\n    public findContainedChild(element: HTMLElement | SVGElement) {\n        return find(this.value, child => {\n            if (child.type === \"single\") {\n                return child.value === element;\n            } else {\n                return child.contains(element);\n            }\n        });\n    }\n    /**\n     * Exact group containing targets\n     */\n    public findExactChild(target: TargetGroupsType[0]): GroupChild | undefined {\n        const map = this.map;\n\n        if (!isArray(target)) {\n            return map.get(target);\n        }\n        const flatted = deepFlat(target);\n        const length = flatted.length;\n        const single = map.get(flatted[0]);\n\n        if (!single) {\n            return;\n        }\n\n        let parent: ArrayChild | undefined = single.parent;\n\n        while (parent) {\n            if (parent.map.size >= length) {\n                return parent;\n            }\n            parent = parent.parent;\n        }\n        return;\n    }\n    public findCommonParent(targets: TargetGroupsType): ArrayChild {\n        let depth = Infinity;\n        let childs = targets.map(target => this.findExactChild(target));\n\n        childs.forEach(child => {\n            if (!child) {\n                return;\n            }\n            depth = Math.min(child.depth, depth);\n        });\n\n        while (depth) {\n            --depth;\n            childs = childs.map(child => {\n                let parent: GroupChild | undefined = child;\n\n                while (parent && parent.depth !== depth) {\n                    parent = parent.parent;\n                }\n\n                return parent;\n            });\n            const firstChild = childs.find(child => child);\n\n            if (!firstChild) {\n                return this;\n            }\n            if (childs.every(child => !child || child === firstChild)) {\n                break;\n            }\n        }\n        const commonParent = childs.find(child => child) as ArrayChild;\n\n        return commonParent || this;\n    }\n    public findNextChild(\n        target: HTMLElement | SVGElement,\n        range: TargetGroupsType = this.toTargetGroups(),\n        isExact = true,\n    ): ArrayChild | null {\n        let nextChild: ArrayChild | null = null;\n\n        const length = range.length;\n\n        range.some(child => {\n            if (!isExact && length === 1 && isArray(child)) {\n                nextChild = this.findNextChild(target, child);\n                return nextChild;\n            }\n\n\n            const nextGroupChild = this.findExactChild(child);\n\n            if (!nextGroupChild) {\n                return;\n            }\n\n            if (\"map\" in nextGroupChild) {\n                if (nextGroupChild.map.has(target)) {\n                    nextChild = nextGroupChild;\n                    return true;\n                }\n            }\n        });\n\n        return nextChild;\n    }\n    public findNextExactChild(\n        target: HTMLElement | SVGElement,\n        selected: Array<HTMLElement | SVGElement>,\n        range: TargetGroupsType = this.toTargetGroups(),\n    ): ArrayChild | null {\n        // [[1, 2]] => group([1, 2]) exact\n        // [[[1, 2], 3]] => group([1, 2])\n        const nextChild = this.findNextChild(target, range, true);\n\n        if (!nextChild) {\n            return null;\n        }\n\n        if (nextChild.compare(selected, -1)) {\n            return nextChild;\n        }\n        return null;\n    }\n    /**\n     * Finds a group that does not overlap within the range and includes the target.\n     */\n    public findPureChild(\n        target: HTMLElement | SVGElement,\n        range: Array<HTMLElement | SVGElement>,\n    ): ArrayChild | null {\n        let nextGroupChild: ArrayChild | null = null;\n\n        const childSelected = range.filter(element => this.has(element));\n\n        if (!childSelected.length) {\n            return this;\n        }\n\n        this.value.some(nextChild => {\n            if (nextChild.type !== \"single\" && nextChild.has(target)) {\n                nextGroupChild = nextChild.findPureChild(target, childSelected);\n\n                if (nextGroupChild) {\n                    return true;\n                }\n            }\n        });\n\n        return nextGroupChild;\n    }\n    public findNextPureChild(\n        target: HTMLElement | SVGElement,\n        range: Array<HTMLElement | SVGElement>,\n    ): ArrayChild | null {\n        const nextChild = this.findNextChild(target);\n\n        if (nextChild) {\n            return nextChild.findPureChild(target, range);\n        }\n        return null;\n    }\n    public getSingleChild(): SingleChild | null {\n        const groupElement = this.groupElement;\n\n        if (groupElement) {\n            const singleChild = this.parent?.value.find(t => t.value === groupElement);\n\n            if (singleChild) {\n                return singleChild as SingleChild;\n            }\n        }\n        return null;\n    }\n    public toTargetGroups(): TargetGroupsType {\n        return this.value.map(child => {\n            if (child.type === \"single\") {\n                return child.value;\n            } else {\n                return child.toTargetGroups();\n            }\n        });\n    }\n    public findArrayChild(targets: TargetGroupsType): ArrayChild | null {\n        const {\n            value,\n        } = this;\n\n        let result = false;\n\n        if (this.type !== \"root\") {\n            result = value.every(child => {\n                if (child.type === \"single\")  {\n                    return targets.some(target => child.value === target);\n                } else {\n                    return targets.some(target => {\n                        return isArray(target) && child.findArrayChild(target);\n                    });\n                }\n            });\n            // result = targets.every(target => {\n            //     if (isArray(target)) {\n            //         return value.some(child => {\n            //             return child.type === \"group\" && child.findArrayChild(target);\n            //         });\n            //     } else {\n            //         return map.get(target);\n            //     }\n            // });\n        }\n\n        if (result && targets.length === value.length) {\n            return this;\n        } else {\n            let childResult: ArrayChild | null = null;\n\n            value.some(child => {\n                if (child.type === \"group\") {\n                    childResult = child.findArrayChild(targets);\n\n                    return childResult;\n                }\n            });\n\n            return childResult;\n        }\n    }\n    public groupByPerfect(selected: Array<HTMLElement | SVGElement>) {\n        return this.value.filter(child => {\n            if (child.type !== \"single\") {\n                return child.compare(selected, -1);\n            }\n            return selected.indexOf(child.value) > -1;\n        }).map(child => {\n            if (child.type !== \"single\") {\n                const singleChild = child.getSingleChild();\n\n                if (singleChild) {\n                    return singleChild;\n                }\n            }\n            return child;\n        });\n    }\n    public add(targets: TargetGroupsObject) {\n        const {\n            value,\n            map,\n        } = this;\n\n        targets.forEach(child => {\n            if (\"groupId\" in child) {\n                const group = new ArrayChild(this);\n\n                group.id = child.groupId;\n                value.push(group);\n                group.add(child.children);\n            } else if (isArray(child)) {\n                const group = new ArrayChild(this);\n\n                value.push(group);\n                group.add(child);\n            } else {\n                const element = \"current\" in child ? child.current : child;\n                const single = new SingleChild(this, element!);\n\n                value.push(single);\n                map.set(element!, single);\n            }\n        });\n\n        value.forEach(child => {\n            if (child.type === \"single\") {\n                map.set(child.value, child);\n            } else {\n                child.map.forEach((nextChild, element) => {\n                    map.set(element, nextChild);\n                });\n            }\n        });\n\n        value.forEach(child => {\n            if  (child.type !== \"single\") {\n                return;\n            }\n            // single\n            const singleElement = child.value;\n            const groupChild = value.find(child2 => {\n                if (child2.type === \"single\") {\n                    return;\n                }\n                const firstElement = [...child2.map.keys()][0];\n\n                if (!firstElement) {\n                    return;\n                }\n\n                return singleElement.contains(firstElement);\n            });\n\n            (child as SingleChild).isGroupElement = !!groupChild;\n\n            if (groupChild) {\n                (groupChild as ArrayChild).groupElement = child.value;\n            }\n        });\n        return parent;\n    }\n}\n","/* eslint-disable no-cond-assign */\nimport { deepFlat, isArray } from \"@daybrush/utils\";\nimport { ArrayChild, SingleChild } from \"./groups\";\nimport { GroupChild, TargetGroupsObject, TargetGroupsType, TargetList } from \"./types\";\n\n\nexport function toTargetList(raw: GroupChild[]): TargetList {\n    function targets(childs: GroupChild[] = []) {\n        const arr: TargetGroupsType = [];\n\n        childs.forEach((child) => {\n            if (child.type === \"single\") {\n                arr.push(child.value);\n            } else {\n                arr.push(targets(child.value));\n            }\n        });\n\n        return arr;\n    }\n\n    return {\n        raw: () => raw,\n        targets() {\n            return targets(this.raw());\n        },\n        flatten() {\n            return deepFlat(this.targets());\n        },\n    };\n}\n\nexport class GroupManager extends ArrayChild {\n    public type = \"root\" as const;\n    private _targets:  Array<HTMLElement | SVGElement> = [];\n\n    constructor(\n        targetGroups: TargetGroupsType,\n        targets?: Array<HTMLElement | SVGElement>,\n    ) {\n        super();\n        this.set(targetGroups, targets);\n    }\n    public set(\n        targetGroups: TargetGroupsObject,\n        targets: Array<HTMLElement | SVGElement> = [],\n    ) {\n        this.map = new Map();\n        this.value = [];\n\n        const map = this.map;\n        const value = this.value;\n\n        this.add(targetGroups);\n        targets.forEach(target => {\n            if (map.has(target)) {\n                return;\n            }\n            const single = new SingleChild(this, target);\n\n            single.depth = 1;\n            value.push(single);\n            map.set(target, single);\n        });\n        this._targets = targets;\n    }\n    public selectSubChilds(targets: TargetGroupsType, target: HTMLElement | SVGElement) {\n        const root = this;\n        const nextChild = root.findNextChild(target, targets, false);\n        const targetChild = root.map.get(target);\n\n        let nextChilds: GroupChild[] = [];\n\n        if (nextChild) {\n            nextChilds = [nextChild];\n        } else if (targetChild) {\n            nextChilds = [targetChild];\n        } else {\n            nextChilds = [];\n        }\n\n        return toTargetList(nextChilds);\n    }\n    public selectSingleChilds(\n        targets: TargetGroupsType,\n        added: Array<HTMLElement | SVGElement>,\n        removed: Array<HTMLElement | SVGElement>,\n    ) {\n        const nextTargets = [...targets];\n\n        // group can't be added, removed.\n        removed.forEach(element => {\n            const index = nextTargets.indexOf(element);\n\n            if (index > -1) {\n                nextTargets.splice(index, 1);\n            }\n        });\n\n        // Targets can be added one by one\n        added.forEach(element => {\n            nextTargets.push(element);\n        });\n\n        return toTargetList(this.toChilds(nextTargets));\n    }\n    public selectCompletedChilds(\n        targets: TargetGroupsType,\n        added: Array<HTMLElement | SVGElement>,\n        removed: Array<HTMLElement | SVGElement>,\n        continueSelect?: boolean,\n    ) {\n        const nextTargets = [...targets];\n        const startSelected = deepFlat(nextTargets);\n\n        // group can be added, removed.\n        removed.forEach(element => {\n            // Single Target\n            const index = nextTargets.indexOf(element);\n\n            if (index > -1) {\n                // single target or group\n                nextTargets.splice(index, 1);\n                return;\n            }\n            // Group Target\n            const removedChild = continueSelect\n                // Finds the nearest child for element and nextTargets.\n                ? this.findNextChild(element, nextTargets)\n                // Find the nearest exact child for element, all removed and nextTargets.\n                : this.findNextExactChild(element, removed, nextTargets);\n\n            if (removedChild) {\n                const groupIndex = nextTargets.findIndex(target => {\n                    return isArray(target) && removedChild.compare(target);\n                });\n\n                if (groupIndex > -1) {\n                    nextTargets.splice(groupIndex, 1);\n                }\n            }\n        });\n\n        added.forEach(element => {\n            const parentGroup = this._findParentGroup(element, startSelected);\n            const nextChild = parentGroup.findContainedChild(element);\n\n            if (nextChild?.type === \"group\") {\n                const singleChild = nextChild.getSingleChild();\n\n                if (singleChild) {\n                    nextTargets.push(singleChild.value);\n                } else {\n                    nextTargets.push(nextChild.toTargetGroups());\n                }\n                return;\n            }\n            nextTargets.push(element);\n        });\n        return toTargetList(this.toChilds(nextTargets));\n    }\n    public selectSameDepthChilds(\n        targets: TargetGroupsType,\n        added: Array<HTMLElement | SVGElement>,\n        removed: Array<HTMLElement | SVGElement>,\n        continueSelect?: boolean,\n    ) {\n        const nextTargets = [...targets];\n        const commonParent = this.findCommonParent(nextTargets);\n\n        removed.forEach(element => {\n            // Single Target\n            const index = nextTargets.indexOf(element);\n\n            if (index > -1) {\n                // single target or group\n                nextTargets.splice(index, 1);\n                return;\n            }\n            const removedChild = continueSelect\n                // Find the nearest exact child for element, all removed and nextTargets.\n                ? commonParent.findNextExactChild(element, removed, nextTargets)\n                // Finds the nearest child for element and nextTargets.\n                : commonParent.findNextChild(element, nextTargets, true);\n\n            if (removedChild) {\n                const groupIndex = nextTargets.findIndex(target => {\n                    return isArray(target) && removedChild.compare(target);\n                });\n\n                if (groupIndex > -1) {\n                    nextTargets.splice(groupIndex, 1);\n                }\n            }\n        });\n        const addedChildren = commonParent.groupByPerfect(added);\n\n        addedChildren.forEach(child => {\n            if (child.type === \"single\") {\n                nextTargets.push(child.value);\n            } else {\n                const groupIndex = nextTargets.findIndex(target => {\n                    return isArray(target) && child.compare(target, 1);\n                });\n\n                if (groupIndex > -1) {\n                    nextTargets.splice(groupIndex, 1);\n                }\n                nextTargets.push(child.toTargetGroups());\n            }\n        });\n        return toTargetList(this.toChilds(nextTargets));\n    }\n    public toChilds(targets: TargetGroupsType): GroupChild[] {\n        const childs: GroupChild[] = [];\n\n        targets.forEach(target => {\n            if (isArray(target)) {\n                const arrayChild = this.findArrayChild(target);\n\n                if (arrayChild) {\n                    const singleChild = arrayChild.getSingleChild();\n\n                    if (singleChild) {\n                        return singleChild;\n                    }\n                    childs.push(arrayChild);\n                }\n            } else {\n                const single = this.map.get(target);\n\n                if (single) {\n                    childs.push(single);\n                } else {\n                    childs.push(new SingleChild(this, target));\n                }\n            }\n        });\n\n        return childs;\n    }\n    public findChild(element: HTMLElement | SVGElement, isAuto: true): SingleChild | ArrayChild;\n    public findChild(\n        element: HTMLElement | SVGElement,\n        isAuto?: boolean,\n    ): SingleChild | ArrayChild | undefined;\n    public findChild(\n        element: HTMLElement | SVGElement,\n        isAuto?: boolean,\n    ): SingleChild | ArrayChild | undefined {\n        const value = this.map.get(element);\n\n        if (isAuto) {\n            return value || new SingleChild(this, element);\n        }\n        return value;\n    }\n    public findArrayChildById(id: string): ArrayChild | null {\n        let value: ArrayChild | null = null;\n\n        this.value.some(function find(child: GroupChild) {\n            if (child.type !== \"single\") {\n                if (child.id === id) {\n                    value = child;\n                    return true;\n                } else {\n                    return child.value.some(find);\n                }\n            }\n        });\n\n        return value;\n    }\n    public group(targets: TargetGroupsType, flatten?: boolean): TargetGroupsType | null {\n        const commonParent = this.findCommonParent(targets);\n        const groupChilds = targets.map(target => {\n            if (isArray(target)) {\n                return this.findArrayChild(target);\n            }\n            return this.findChild(target);\n        });\n        const isGroupable = groupChilds.every(child => child?.parent === commonParent);\n\n        if (!isGroupable) {\n            return null;\n        }\n        const group = new ArrayChild(commonParent);\n        const nextChilds = commonParent.value.filter(target => groupChilds.indexOf(target) === -1);\n\n        if (!nextChilds.length) {\n            return null;\n        }\n        nextChilds.unshift(group);\n        group.add(flatten ? deepFlat(targets) : targets);\n        commonParent.value = nextChilds;\n\n        this.set(this.toTargetGroups(), this._targets);\n\n        return group.toTargetGroups();\n    }\n    public ungroup(targets: TargetGroupsType) {\n        if (targets.length === 1 && isArray(targets[0])) {\n            targets = targets[0];\n        }\n        const commonParent = this.findCommonParent(targets);\n        const groupChilds = targets.map(target => {\n            if (isArray(target)) {\n                return this.findArrayChild(target);\n            }\n            return this.findChild(target);\n        });\n\n        if (commonParent.groupElement) {\n            return null;\n        }\n\n        // all children is targets\n        const isGroupable = commonParent.value.every(child => groupChilds.indexOf(child) > -1);\n\n        if (!isGroupable || commonParent === this) {\n            // has no group\n            return null;\n        }\n\n        const parent = commonParent.parent;\n\n        if (!parent) {\n            return null;\n        }\n        const nextChilds = parent.value.filter(target => target !== commonParent);\n\n        nextChilds.push(...commonParent.value);\n        parent.value = nextChilds;\n\n        this.set(this.toTargetGroups(), this._targets);\n        return commonParent.toTargetGroups();\n    }\n    protected _findParentGroup(\n        element: HTMLElement | SVGElement,\n        range: Array<HTMLElement | SVGElement>,\n    ) {\n        if (!range.length) {\n            return this;\n        }\n        const single = this.map.get(element);\n\n        if (!single) {\n            return this;\n        }\n        let parent: ArrayChild | undefined = single.parent;\n\n        while (parent) {\n            if (range.some(element => parent!.contains(element))) {\n                return parent;\n            }\n            parent = parent.parent;\n        }\n        return this;\n    }\n}\n"],"names":["Child","parent","type","depth","_scope","Object","defineProperty","get","__spreadArray","scope","id","SingleChild","_super","__extends","value","_this","call","isGroupElement","ArrayChild","apply","arguments","groupElement","map","Map","compare","groups","checker","elements","deepFlat","elementsLength","length","mapSize","size","sizeDiff","count","filter","element","has","target","contains","some","child","findContainedChild","find","findExactChild","isArray","flatted","single","findCommonParent","targets","Infinity","childs","forEach","Math","min","firstChild","every","commonParent","findNextChild","range","isExact","toTargetGroups","nextChild","nextGroupChild","findNextExactChild","selected","findPureChild","childSelected","findNextPureChild","getSingleChild","singleChild","_a","t","findArrayChild","result","childResult_1","groupByPerfect","indexOf","add","group","groupId","push","children","current","set","singleElement","groupChild","child2","firstElement","keys","toTargetList","raw","arr","flatten","GroupManager","targetGroups","_targets","selectSubChilds","root","targetChild","nextChilds","selectSingleChilds","added","removed","nextTargets","index","splice","toChilds","selectCompletedChilds","continueSelect","startSelected","removedChild","groupIndex","findIndex","parentGroup","_findParentGroup","selectSameDepthChilds","addedChildren","arrayChild","findChild","isAuto","findArrayChildById","groupChilds","isGroupable","unshift","ungroup"],"mappings":"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"}