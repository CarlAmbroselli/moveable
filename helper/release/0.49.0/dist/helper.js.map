{"version":3,"file":"helper.js","sources":["../src/groups.ts","../src/GroupManager.ts"],"sourcesContent":["import { isArray, deepFlat, find } from \"@daybrush/utils\";\nimport { GroupChild, TargetGroupsObject, TargetGroupsType } from \"./types\";\n\nexport class Child {\n    public type: \"group\" | \"root\" | \"single\" = \"single\";\n    public depth = 0;\n    protected _scope: string[] = [];\n    constructor(public parent?: ArrayChild) {\n        if (parent) {\n            this.depth = parent.depth + 1;\n        }\n    }\n\n    public get scope(): string[] {\n        const parent = this.parent;\n\n        if (!parent || parent.type === \"root\") {\n            return [];\n        }\n        return [...parent.scope, parent.id];\n    }\n}\n\nexport class SingleChild extends Child {\n    public type = \"single\" as const;\n    public isGroupElement = false;\n    constructor(parent: ArrayChild, public value: HTMLElement | SVGElement) {\n        super(parent);\n    }\n}\n\n\nexport class ArrayChild extends Child {\n    public type: \"group\" | \"root\" = \"group\";\n    public value: GroupChild[] = [];\n    public id = \"\";\n    public groupElement?: HTMLElement | SVGElement | null = null;\n    public map: Map<HTMLElement | SVGElement, SingleChild> = new Map();\n\n    public compare(groups: TargetGroupsType, checker: -1 | 0 | 1 = 0) {\n        const elements = deepFlat(groups);\n        const map = this.map;\n        const elementsLength = elements.length;\n        const mapSize = map.size;\n        const sizeDiff = mapSize - elementsLength;\n\n        // 1 this > groups\n        // 0 this = groups\n        // -1 this < groups\n        const count = elements.filter(element => map.has(element)).length;\n\n        if ((checker > 0 && sizeDiff >= 0) || (checker === 0 && sizeDiff === 0)) {\n            return elementsLength === count;\n        } else if (checker < 0 && sizeDiff <= 0) {\n            return mapSize === count;\n        }\n        return false;\n    }\n    public has(target: HTMLElement | SVGElement) {\n        return this.map.has(target);\n    }\n    public contains(element: HTMLElement | SVGElement): boolean {\n        if (this.has(element)) {\n            return true;\n        }\n        return this.value.some(child => {\n            if (child.type === \"group\") {\n                return child.contains(element);\n            } else {\n                return false;\n            }\n        });\n    }\n    public findContainedChild(element: HTMLElement | SVGElement) {\n        return find(this.value, child => {\n            if (child.type === \"single\") {\n                return child.value === element;\n            } else {\n                return child.contains(element);\n            }\n        });\n    }\n    /**\n     * Exact group containing targets\n     */\n    public findExactChild(target: TargetGroupsType[0]): GroupChild | undefined {\n        const map = this.map;\n\n        if (!isArray(target)) {\n            return map.get(target);\n        }\n        const flatted = deepFlat(target);\n        const length = flatted.length;\n        const single = map.get(flatted[0]);\n\n        if (!single) {\n            return;\n        }\n\n        let parent: ArrayChild | undefined = single.parent;\n\n        while (parent) {\n            if (parent.map.size >= length) {\n                return parent;\n            }\n            parent = parent.parent;\n        }\n        return;\n    }\n    public findCommonParent(targets: TargetGroupsType): ArrayChild {\n        let depth = Infinity;\n        let childs = targets.map(target => this.findExactChild(target));\n\n        childs.forEach(child => {\n            if (!child) {\n                return;\n            }\n            depth = Math.min(child.depth, depth);\n        });\n\n        while (depth) {\n            --depth;\n            childs = childs.map(child => {\n                let parent: GroupChild | undefined = child;\n\n                while (parent && parent.depth !== depth) {\n                    parent = parent.parent;\n                }\n\n                return parent;\n            });\n            const firstChild = childs.find(child => child);\n\n            if (!firstChild) {\n                return this;\n            }\n            if (childs.every(child => !child || child === firstChild)) {\n                break;\n            }\n        }\n        const commonParent = childs.find(child => child) as ArrayChild;\n\n        return commonParent || this;\n    }\n    public findNextChild(\n        target: HTMLElement | SVGElement,\n        range: TargetGroupsType = this.toTargetGroups(),\n        isExact = true,\n    ): ArrayChild | null {\n        let nextChild: ArrayChild | null = null;\n\n        const length = range.length;\n\n        range.some(child => {\n            if (!isExact && length === 1 && isArray(child)) {\n                nextChild = this.findNextChild(target, child);\n                return nextChild;\n            }\n\n\n            const nextGroupChild = this.findExactChild(child);\n\n            if (!nextGroupChild) {\n                return;\n            }\n\n            if (\"map\" in nextGroupChild) {\n                if (nextGroupChild.map.has(target)) {\n                    nextChild = nextGroupChild;\n                    return true;\n                }\n            }\n        });\n\n        return nextChild;\n    }\n    public findNextExactChild(\n        target: HTMLElement | SVGElement,\n        selected: Array<HTMLElement | SVGElement>,\n        range: TargetGroupsType = this.toTargetGroups(),\n    ): ArrayChild | null {\n        // [[1, 2]] => group([1, 2]) exact\n        // [[[1, 2], 3]] => group([1, 2])\n        const nextChild = this.findNextChild(target, range, true);\n\n        if (!nextChild) {\n            return null;\n        }\n\n        if (nextChild.compare(selected, -1)) {\n            return nextChild;\n        }\n        return null;\n    }\n    /**\n     * Finds a group that does not overlap within the range and includes the target.\n     */\n    public findPureChild(\n        target: HTMLElement | SVGElement,\n        range: Array<HTMLElement | SVGElement>,\n    ): ArrayChild | null {\n        let nextGroupChild: ArrayChild | null = null;\n\n        const childSelected = range.filter(element => this.has(element));\n\n        if (!childSelected.length) {\n            return this;\n        }\n\n        this.value.some(nextChild => {\n            if (nextChild.type !== \"single\" && nextChild.has(target)) {\n                nextGroupChild = nextChild.findPureChild(target, childSelected);\n\n                if (nextGroupChild) {\n                    return true;\n                }\n            }\n        });\n\n        return nextGroupChild;\n    }\n    public findNextPureChild(\n        target: HTMLElement | SVGElement,\n        range: Array<HTMLElement | SVGElement>,\n    ): ArrayChild | null {\n        const nextChild = this.findNextChild(target);\n\n        if (nextChild) {\n            return nextChild.findPureChild(target, range);\n        }\n        return null;\n    }\n    public getSingleChild(): SingleChild | null {\n        const groupElement = this.groupElement;\n\n        if (groupElement) {\n            const singleChild = this.parent?.value.find(t => t.value === groupElement);\n\n            if (singleChild) {\n                return singleChild as SingleChild;\n            }\n        }\n        return null;\n    }\n    public toTargetGroups(): TargetGroupsType {\n        return this.value.map(child => {\n            if (child.type === \"single\") {\n                return child.value;\n            } else {\n                return child.toTargetGroups();\n            }\n        });\n    }\n    public findArrayChild(targets: TargetGroupsType): ArrayChild | null {\n        const {\n            value,\n        } = this;\n\n        let result = false;\n\n        if (this.type !== \"root\") {\n            result = value.every(child => {\n                if (child.type === \"single\")  {\n                    return targets.some(target => child.value === target);\n                } else {\n                    return targets.some(target => {\n                        return isArray(target) && child.findArrayChild(target);\n                    });\n                }\n            });\n            // result = targets.every(target => {\n            //     if (isArray(target)) {\n            //         return value.some(child => {\n            //             return child.type === \"group\" && child.findArrayChild(target);\n            //         });\n            //     } else {\n            //         return map.get(target);\n            //     }\n            // });\n        }\n\n        if (result && targets.length === value.length) {\n            return this;\n        } else {\n            let childResult: ArrayChild | null = null;\n\n            value.some(child => {\n                if (child.type === \"group\") {\n                    childResult = child.findArrayChild(targets);\n\n                    return childResult;\n                }\n            });\n\n            return childResult;\n        }\n    }\n    public groupByPerfect(selected: Array<HTMLElement | SVGElement>) {\n        return this.value.filter(child => {\n            if (child.type !== \"single\") {\n                return child.compare(selected, -1);\n            }\n            return selected.indexOf(child.value) > -1;\n        }).map(child => {\n            if (child.type !== \"single\") {\n                const singleChild = child.getSingleChild();\n\n                if (singleChild) {\n                    return singleChild;\n                }\n            }\n            return child;\n        });\n    }\n    public add(targets: TargetGroupsObject) {\n        const {\n            value,\n            map,\n        } = this;\n\n        targets.forEach(child => {\n            if (\"groupId\" in child) {\n                const group = new ArrayChild(this);\n\n                group.id = child.groupId;\n                value.push(group);\n                group.add(child.children);\n            } else if (isArray(child)) {\n                const group = new ArrayChild(this);\n\n                value.push(group);\n                group.add(child);\n            } else {\n                const element = \"current\" in child ? child.current : child;\n                const single = new SingleChild(this, element!);\n\n                value.push(single);\n                map.set(element!, single);\n            }\n        });\n\n        value.forEach(child => {\n            if (child.type === \"single\") {\n                map.set(child.value, child);\n            } else {\n                child.map.forEach((nextChild, element) => {\n                    map.set(element, nextChild);\n                });\n            }\n        });\n\n        value.forEach(child => {\n            if  (child.type !== \"single\") {\n                return;\n            }\n            // single\n            const singleElement = child.value;\n            const groupChild = value.find(child2 => {\n                if (child2.type === \"single\") {\n                    return;\n                }\n                const firstElement = [...child2.map.keys()][0];\n\n                if (!firstElement) {\n                    return;\n                }\n\n                return singleElement.contains(firstElement);\n            });\n\n            (child as SingleChild).isGroupElement = !!groupChild;\n\n            if (groupChild) {\n                (groupChild as ArrayChild).groupElement = child.value;\n            }\n        });\n        return parent;\n    }\n}\n","/* eslint-disable no-cond-assign */\nimport { deepFlat, isArray } from \"@daybrush/utils\";\nimport { ArrayChild, SingleChild } from \"./groups\";\nimport { GroupChild, TargetGroupsObject, TargetGroupsType, TargetList } from \"./types\";\n\n\nexport function toTargetList(raw: GroupChild[]): TargetList {\n    function targets(childs: GroupChild[] = []) {\n        const arr: TargetGroupsType = [];\n\n        childs.forEach((child) => {\n            if (child.type === \"single\") {\n                arr.push(child.value);\n            } else {\n                arr.push(targets(child.value));\n            }\n        });\n\n        return arr;\n    }\n\n    return {\n        raw: () => raw,\n        targets() {\n            return targets(this.raw());\n        },\n        flatten() {\n            return deepFlat(this.targets());\n        },\n    };\n}\n\nexport class GroupManager extends ArrayChild {\n    public type = \"root\" as const;\n    private _targets:  Array<HTMLElement | SVGElement> = [];\n\n    constructor(\n        targetGroups: TargetGroupsType,\n        targets?: Array<HTMLElement | SVGElement>,\n    ) {\n        super();\n        this.set(targetGroups, targets);\n    }\n    public set(\n        targetGroups: TargetGroupsObject,\n        targets: Array<HTMLElement | SVGElement> = [],\n    ) {\n        this.map = new Map();\n        this.value = [];\n\n        const map = this.map;\n        const value = this.value;\n\n        this.add(targetGroups);\n        targets.forEach(target => {\n            if (map.has(target)) {\n                return;\n            }\n            const single = new SingleChild(this, target);\n\n            single.depth = 1;\n            value.push(single);\n            map.set(target, single);\n        });\n        this._targets = targets;\n    }\n    public selectSubChilds(targets: TargetGroupsType, target: HTMLElement | SVGElement) {\n        const root = this;\n        const nextChild = root.findNextChild(target, targets, false);\n        const targetChild = root.map.get(target);\n\n        let nextChilds: GroupChild[] = [];\n\n        if (nextChild) {\n            nextChilds = [nextChild];\n        } else if (targetChild) {\n            nextChilds = [targetChild];\n        } else {\n            nextChilds = [];\n        }\n\n        return toTargetList(nextChilds);\n    }\n    public selectSingleChilds(\n        targets: TargetGroupsType,\n        added: Array<HTMLElement | SVGElement>,\n        removed: Array<HTMLElement | SVGElement>,\n    ) {\n        const nextTargets = [...targets];\n\n        // group can't be added, removed.\n        removed.forEach(element => {\n            const index = nextTargets.indexOf(element);\n\n            if (index > -1) {\n                nextTargets.splice(index, 1);\n            }\n        });\n\n        // Targets can be added one by one\n        added.forEach(element => {\n            nextTargets.push(element);\n        });\n\n        return toTargetList(this.toChilds(nextTargets));\n    }\n    public selectCompletedChilds(\n        targets: TargetGroupsType,\n        added: Array<HTMLElement | SVGElement>,\n        removed: Array<HTMLElement | SVGElement>,\n        continueSelect?: boolean,\n    ) {\n        const nextTargets = [...targets];\n        const startSelected = deepFlat(nextTargets);\n\n        // group can be added, removed.\n        removed.forEach(element => {\n            // Single Target\n            const index = nextTargets.indexOf(element);\n\n            if (index > -1) {\n                // single target or group\n                nextTargets.splice(index, 1);\n                return;\n            }\n            // Group Target\n            const removedChild = continueSelect\n                // Finds the nearest child for element and nextTargets.\n                ? this.findNextChild(element, nextTargets)\n                // Find the nearest exact child for element, all removed and nextTargets.\n                : this.findNextExactChild(element, removed, nextTargets);\n\n            if (removedChild) {\n                const groupIndex = nextTargets.findIndex(target => {\n                    return isArray(target) && removedChild.compare(target);\n                });\n\n                if (groupIndex > -1) {\n                    nextTargets.splice(groupIndex, 1);\n                }\n            }\n        });\n\n        added.forEach(element => {\n            const parentGroup = this._findParentGroup(element, startSelected);\n            const nextChild = parentGroup.findContainedChild(element);\n\n            if (nextChild?.type === \"group\") {\n                const singleChild = nextChild.getSingleChild();\n\n                if (singleChild) {\n                    nextTargets.push(singleChild.value);\n                } else {\n                    nextTargets.push(nextChild.toTargetGroups());\n                }\n                return;\n            }\n            nextTargets.push(element);\n        });\n        return toTargetList(this.toChilds(nextTargets));\n    }\n    public selectSameDepthChilds(\n        targets: TargetGroupsType,\n        added: Array<HTMLElement | SVGElement>,\n        removed: Array<HTMLElement | SVGElement>,\n        continueSelect?: boolean,\n    ) {\n        const nextTargets = [...targets];\n        const commonParent = this.findCommonParent(nextTargets);\n\n        removed.forEach(element => {\n            // Single Target\n            const index = nextTargets.indexOf(element);\n\n            if (index > -1) {\n                // single target or group\n                nextTargets.splice(index, 1);\n                return;\n            }\n            const removedChild = continueSelect\n                // Find the nearest exact child for element, all removed and nextTargets.\n                ? commonParent.findNextExactChild(element, removed, nextTargets)\n                // Finds the nearest child for element and nextTargets.\n                : commonParent.findNextChild(element, nextTargets, true);\n\n            if (removedChild) {\n                const groupIndex = nextTargets.findIndex(target => {\n                    return isArray(target) && removedChild.compare(target);\n                });\n\n                if (groupIndex > -1) {\n                    nextTargets.splice(groupIndex, 1);\n                }\n            }\n        });\n        const addedChildren = commonParent.groupByPerfect(added);\n\n        addedChildren.forEach(child => {\n            if (child.type === \"single\") {\n                nextTargets.push(child.value);\n            } else {\n                const groupIndex = nextTargets.findIndex(target => {\n                    return isArray(target) && child.compare(target, 1);\n                });\n\n                if (groupIndex > -1) {\n                    nextTargets.splice(groupIndex, 1);\n                }\n                nextTargets.push(child.toTargetGroups());\n            }\n        });\n        return toTargetList(this.toChilds(nextTargets));\n    }\n    public toChilds(targets: TargetGroupsType): GroupChild[] {\n        const childs: GroupChild[] = [];\n\n        targets.forEach(target => {\n            if (isArray(target)) {\n                const arrayChild = this.findArrayChild(target);\n\n                if (arrayChild) {\n                    const singleChild = arrayChild.getSingleChild();\n\n                    if (singleChild) {\n                        return singleChild;\n                    }\n                    childs.push(arrayChild);\n                }\n            } else {\n                const single = this.map.get(target);\n\n                if (single) {\n                    childs.push(single);\n                } else {\n                    childs.push(new SingleChild(this, target));\n                }\n            }\n        });\n\n        return childs;\n    }\n    public findChild(element: HTMLElement | SVGElement, isAuto: true): SingleChild | ArrayChild;\n    public findChild(\n        element: HTMLElement | SVGElement,\n        isAuto?: boolean,\n    ): SingleChild | ArrayChild | undefined;\n    public findChild(\n        element: HTMLElement | SVGElement,\n        isAuto?: boolean,\n    ): SingleChild | ArrayChild | undefined {\n        const value = this.map.get(element);\n\n        if (isAuto) {\n            return value || new SingleChild(this, element);\n        }\n        return value;\n    }\n    public findArrayChildById(id: string): ArrayChild | null {\n        let value: ArrayChild | null = null;\n\n        this.value.some(function find(child: GroupChild) {\n            if (child.type !== \"single\") {\n                if (child.id === id) {\n                    value = child;\n                    return true;\n                } else {\n                    return child.value.some(find);\n                }\n            }\n        });\n\n        return value;\n    }\n    public group(targets: TargetGroupsType, flatten?: boolean): TargetGroupsType | null {\n        const commonParent = this.findCommonParent(targets);\n        const groupChilds = targets.map(target => {\n            if (isArray(target)) {\n                return this.findArrayChild(target);\n            }\n            return this.findChild(target);\n        });\n        const isGroupable = groupChilds.every(child => child?.parent === commonParent);\n\n        if (!isGroupable) {\n            return null;\n        }\n        const group = new ArrayChild(commonParent);\n        const nextChilds = commonParent.value.filter(target => groupChilds.indexOf(target) === -1);\n\n        if (!nextChilds.length) {\n            return null;\n        }\n        nextChilds.unshift(group);\n        group.add(flatten ? deepFlat(targets) : targets);\n        commonParent.value = nextChilds;\n\n        this.set(this.toTargetGroups(), this._targets);\n\n        return group.toTargetGroups();\n    }\n    public ungroup(targets: TargetGroupsType) {\n        if (targets.length === 1 && isArray(targets[0])) {\n            targets = targets[0];\n        }\n        const commonParent = this.findCommonParent(targets);\n        const groupChilds = targets.map(target => {\n            if (isArray(target)) {\n                return this.findArrayChild(target);\n            }\n            return this.findChild(target);\n        });\n\n        if (commonParent.groupElement) {\n            return null;\n        }\n\n        // all children is targets\n        const isGroupable = commonParent.value.every(child => groupChilds.indexOf(child) > -1);\n\n        if (!isGroupable || commonParent === this) {\n            // has no group\n            return null;\n        }\n\n        const parent = commonParent.parent;\n\n        if (!parent) {\n            return null;\n        }\n        const nextChilds = parent.value.filter(target => target !== commonParent);\n\n        nextChilds.push(...commonParent.value);\n        parent.value = nextChilds;\n\n        this.set(this.toTargetGroups(), this._targets);\n        return commonParent.toTargetGroups();\n    }\n    protected _findParentGroup(\n        element: HTMLElement | SVGElement,\n        range: Array<HTMLElement | SVGElement>,\n    ) {\n        if (!range.length) {\n            return this;\n        }\n        const single = this.map.get(element);\n\n        if (!single) {\n            return this;\n        }\n        let parent: ArrayChild | undefined = single.parent;\n\n        while (parent) {\n            if (range.some(element => parent!.contains(element))) {\n                return parent;\n            }\n            parent = parent.parent;\n        }\n        return this;\n    }\n}\n"],"names":["Child","parent","type","depth","_scope","Object","defineProperty","get","__spreadArray","scope","id","SingleChild","_super","__extends","value","_this","call","isGroupElement","ArrayChild","apply","arguments","groupElement","map","Map","compare","groups","checker","elements","deepFlat","elementsLength","length","mapSize","size","sizeDiff","count","filter","element","has","target","contains","some","child","findContainedChild","find","findExactChild","isArray","flatted","single","findCommonParent","targets","Infinity","childs","forEach","Math","min","firstChild","every","commonParent","findNextChild","range","isExact","toTargetGroups","nextChild","nextGroupChild","findNextExactChild","selected","findPureChild","childSelected","findNextPureChild","getSingleChild","singleChild","_a","t","findArrayChild","result","childResult_1","groupByPerfect","indexOf","add","group","groupId","push","children","current","set","singleElement","groupChild","child2","firstElement","keys","toTargetList","raw","arr","flatten","GroupManager","targetGroups","_targets","selectSubChilds","root","targetChild","nextChilds","selectSingleChilds","added","removed","nextTargets","index","splice","toChilds","selectCompletedChilds","continueSelect","startSelected","removedChild","groupIndex","findIndex","parentGroup","_findParentGroup","selectSameDepthChilds","addedChildren","arrayChild","findChild","isAuto","findArrayChildById","groupChilds","isGroupable","unshift","ungroup"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAGA,IAAAA,KAAA;IAAA;IAAA,YAAA;MAII,SAAAA,KAAA,CAAmBC,MAAnB,EAAsC;QAAnB,IAAMA,CAAAA,MAAN,GAAAA,MAAA,CAAA;QAHZ,IAAIC,CAAAA,IAAJ,GAAoC,QAApC,CAAA;QACA,IAAKC,CAAAA,KAAL,GAAQ,CAAR,CAAA;QACG,IAAMC,CAAAA,MAAN,GAAmB,EAAnB,CAAA;;IAEN,IAAA,IAAIH,MAAJ,EAAY;IACR,MAAA,IAAA,CAAKE,KAAL,GAAaF,MAAM,CAACE,KAAP,GAAe,CAA5B,CAAA;IACH,KAAA;IACJ,GAAA;;IARL,EAAA,IAAA,OAAA,GAAA,KAAA,CAAA,SAAA,CAAA;IAUIE,EAAAA,MAAA,CAAAC,cAAA,CAAgB,OAAA,EAAA,OAAhB,EAAgB;IAAhBC,IAAAA,GAAA,EAAA,YAAA;UACI,IAAMN,MAAM,GAAG,IAAA,CAAKA,MAApB,CAAA;;UAEA,IAAI,CAACA,MAAD,IAAWA,MAAM,CAACC,IAAP,KAAgB,MAA/B,EAAuC;IACnC,QAAA,OAAO,EAAP,CAAA;IACH,OAAA;;UACD,OAAAM,aAAA,CAAAA,aAAA,CAAA,EAAA,EAAWP,MAAM,CAACQ,KAAlB,MAAA,CAAA,GAAyBR,MAAM,CAACS,GAAhC,EAAoC,KAApC,CAAA,CAAA;SANY;yBAAA;;OAAhB,CAAA,CAAA;IAQJ,EAAA,OAACV,KAAD,CAAA;IAAC,CAlBD,EAAA,CAAA;;IAoBA,IAAAW,WAAA;IAAA;IAAA,UAAAC,MAAA,EAAA;IAAiCC,EAAAA,SAAK,CAAAF,WAAA,EAAAC,MAAA,CAAL,CAAA;;IAG7B,EAAA,SAAYD,WAAZ,CAAYV,MAAZ,EAAuCa,KAAvC,EAAsE;QAAtE,IACIC,KAAA,GAAAH,MAAA,CAAAI,IAAA,CAAA,IAAA,EAAMf,MAAN,CAAA,IACH,IAFD,CAAA;;QAAuCc,KAAK,CAAAD,KAAL,GAAAA,KAAA,CAAA;QAFhCC,KAAI,CAAAb,IAAJ,GAAO,QAAP,CAAA;QACAa,KAAc,CAAAE,cAAd,GAAiB,KAAjB,CAAA;;IAGN,GAAA;;IACL,EAAA,OAACN,WAAD,CAAA;IANA,CAAA,CAAiCX,KAAjC,CAAA,CAAA;;IASA,IAAAkB,UAAA;IAAA;IAAA,UAAAN,MAAA,EAAA;IAAgCC,EAAAA,SAAK,CAAAK,UAAA,EAAAN,MAAA,CAAL,CAAA;;IAAhC,EAAA,SAAAM,UAAA,GAAA;IAAA,IAAA,IA0VCH,KAAA,GAAAH,MAAA,KAAA,IAAA,IAAAA,MAAA,CAAAO,KAAA,CAAA,IAAA,EAAAC,SAAA,CAAA,IAAA,IA1VD,CAAA;;QACWL,KAAI,CAAAb,IAAJ,GAAyB,OAAzB,CAAA;QACAa,KAAK,CAAAD,KAAL,GAAsB,EAAtB,CAAA;QACAC,KAAE,CAAAL,EAAF,GAAK,EAAL,CAAA;QACAK,KAAY,CAAAM,YAAZ,GAAiD,IAAjD,CAAA;IACAN,IAAAA,KAAA,CAAAO,GAAA,GAAkD,IAAIC,GAAJ,EAAlD,CAAA;;IAqVV,GAAA;;IA1VD,EAAA,IAAA,OAAA,GAAA,UAAA,CAAA,SAAA,CAAA;;IAOW,EAAA,OAAA,CAAAC,OAAA,GAAP,UAAeC,MAAf,EAAyCC,OAAzC,EAAgE;IAAvB,IAAA,IAAAA,OAAA,KAAA,KAAA,CAAA,EAAA;IAAAA,MAAAA,OAAuB,GAAA,CAAvB,CAAA;IAAuB,KAAA;;IAC5D,IAAA,IAAMC,QAAQ,GAAGC,QAAQ,CAACH,MAAD,CAAzB,CAAA;QACA,IAAMH,GAAG,GAAG,IAAA,CAAKA,GAAjB,CAAA;IACA,IAAA,IAAMO,cAAc,GAAGF,QAAQ,CAACG,MAAhC,CAAA;IACA,IAAA,IAAMC,OAAO,GAAGT,GAAG,CAACU,IAApB,CAAA;IACA,IAAA,IAAMC,QAAQ,GAAGF,OAAO,GAAGF,cAA3B,CAL4D;IAQ5D;IACA;;QACA,IAAMK,KAAK,GAAGP,QAAQ,CAACQ,MAAT,CAAgB,UAAAC,OAAA,EAAW;IAAA,MAAA,OAAAd,GAAG,CAACe,GAAJ,CAAQD,OAAR,CAAA,CAAA;IAAgB,KAA3C,EAA6CN,MAA3D,CAAA;;IAEA,IAAA,IAAKJ,OAAO,GAAG,CAAV,IAAeO,QAAQ,IAAI,CAA5B,IAAmCP,OAAO,KAAK,CAAZ,IAAiBO,QAAQ,KAAK,CAArE,EAAyE;UACrE,OAAOJ,cAAc,KAAKK,KAA1B,CAAA;SADJ,MAEO,IAAIR,OAAO,GAAG,CAAV,IAAeO,QAAQ,IAAI,CAA/B,EAAkC;UACrC,OAAOF,OAAO,KAAKG,KAAnB,CAAA;IACH,KAAA;;IACD,IAAA,OAAO,KAAP,CAAA;OAjBG,CAAA;;IAmBA,EAAA,OAAA,CAAGG,GAAH,GAAP,UAAWC,MAAX,EAA2C;IACvC,IAAA,OAAO,KAAKhB,GAAL,CAASe,GAAT,CAAaC,MAAb,CAAP,CAAA;OADG,CAAA;;IAGA,EAAA,OAAA,CAAQC,QAAR,GAAP,UAAgBH,OAAhB,EAAiD;IAC7C,IAAA,IAAI,IAAKC,CAAAA,GAAL,CAASD,OAAT,CAAJ,EAAuB;IACnB,MAAA,OAAO,IAAP,CAAA;IACH,KAAA;;IACD,IAAA,OAAO,KAAKtB,KAAL,CAAW0B,IAAX,CAAgB,UAAAC,KAAA,EAAK;IACxB,MAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,OAAnB,EAA4B;IACxB,QAAA,OAAOuC,KAAK,CAACF,QAAN,CAAeH,OAAf,CAAP,CAAA;IACH,OAFD,MAEO;IACH,QAAA,OAAO,KAAP,CAAA;IACH,OAAA;IACJ,KANM,CAAP,CAAA;OAJG,CAAA;;IAYA,EAAA,OAAA,CAAkBM,kBAAlB,GAAP,UAA0BN,OAA1B,EAA2D;IACvD,IAAA,OAAOO,IAAI,CAAC,IAAA,CAAK7B,KAAN,EAAa,UAAA2B,KAAA,EAAK;IACzB,MAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,QAAnB,EAA6B;IACzB,QAAA,OAAOuC,KAAK,CAAC3B,KAAN,KAAgBsB,OAAvB,CAAA;IACH,OAFD,MAEO;IACH,QAAA,OAAOK,KAAK,CAACF,QAAN,CAAeH,OAAf,CAAP,CAAA;IACH,OAAA;IACJ,KANU,CAAX,CAAA;OADG,CAAA;IASP;;IAEG;;;IACI,EAAA,OAAA,CAAcQ,cAAd,GAAP,UAAsBN,MAAtB,EAAiD;QAC7C,IAAMhB,GAAG,GAAG,IAAA,CAAKA,GAAjB,CAAA;;IAEA,IAAA,IAAI,CAACuB,OAAO,CAACP,MAAD,CAAZ,EAAsB;IAClB,MAAA,OAAOhB,GAAG,CAACf,GAAJ,CAAQ+B,MAAR,CAAP,CAAA;IACH,KAAA;;IACD,IAAA,IAAMQ,OAAO,GAAGlB,QAAQ,CAACU,MAAD,CAAxB,CAAA;IACA,IAAA,IAAMR,MAAM,GAAGgB,OAAO,CAAChB,MAAvB,CAAA;QACA,IAAMiB,MAAM,GAAGzB,GAAG,CAACf,GAAJ,CAAQuC,OAAO,CAAC,CAAD,CAAf,CAAf,CAAA;;QAEA,IAAI,CAACC,MAAL,EAAa;IACT,MAAA,OAAA;IACH,KAAA;;IAED,IAAA,IAAI9C,MAAM,GAA2B8C,MAAM,CAAC9C,MAA5C,CAAA;;IAEA,IAAA,OAAOA,MAAP,EAAe;IACX,MAAA,IAAIA,MAAM,CAACqB,GAAP,CAAWU,IAAX,IAAmBF,MAAvB,EAA+B;IAC3B,QAAA,OAAO7B,MAAP,CAAA;IACH,OAAA;;UACDA,MAAM,GAAGA,MAAM,CAACA,MAAhB,CAAA;IACH,KAAA;;IACD,IAAA,OAAA;OAtBG,CAAA;;IAwBA,EAAA,OAAA,CAAgB+C,gBAAhB,GAAP,UAAwBC,OAAxB,EAAiD;QAAjD,IAkCClC,KAAA,GAAA,IAlCD,CAAA;;QACI,IAAIZ,KAAK,GAAG+C,QAAZ,CAAA;QACA,IAAIC,MAAM,GAAGF,OAAO,CAAC3B,GAAR,CAAY,UAAAgB,MAAA,EAAM;IAAI,MAAA,OAAAvB,KAAI,CAAC6B,cAAL,CAAoBN,MAApB,CAAA,CAAA;IAA2B,KAAjD,CAAb,CAAA;IAEAa,IAAAA,MAAM,CAACC,OAAP,CAAe,UAAAX,KAAA,EAAK;UAChB,IAAI,CAACA,KAAL,EAAY;IACR,QAAA,OAAA;IACH,OAAA;;UACDtC,KAAK,GAAGkD,IAAI,CAACC,GAAL,CAASb,KAAK,CAACtC,KAAf,EAAsBA,KAAtB,CAAR,CAAA;SAJJ,CAAA,CAAA;;;IAQI,MAAA,EAAEA,KAAF,CAAA;IACAgD,MAAAA,MAAM,GAAGA,MAAM,CAAC7B,GAAP,CAAW,UAAAmB,KAAA,EAAK;YACrB,IAAIxC,MAAM,GAA2BwC,KAArC,CAAA;;IAEA,QAAA,OAAOxC,MAAM,IAAIA,MAAM,CAACE,KAAP,KAAiBA,KAAlC,EAAyC;cACrCF,MAAM,GAAGA,MAAM,CAACA,MAAhB,CAAA;IACH,SAAA;;IAED,QAAA,OAAOA,MAAP,CAAA;IACH,OARQ,CAAT,CAAA;UASA,IAAMsD,UAAU,GAAGJ,MAAM,CAACR,IAAP,CAAY,UAAAF,KAAA,EAAK;IAAI,QAAA,OAAAA,KAAA,CAAA;IAAK,OAA1B,CAAnB,CAAA;;UAEA,IAAI,CAACc,UAAL,EAAiB;;;;IAEhB,OAAA;;IACD,MAAA,IAAIJ,MAAM,CAACK,KAAP,CAAa,UAAAf,KAAA,EAAS;IAAA,QAAA,OAAA,CAACA,KAAD,IAAUA,KAAK,KAAKc,UAApB,CAAA;IAA8B,OAApD,CAAJ,EAA2D;;IAE1D,OAAA;;;;;IAlBL,IAAA,OAAOpD,KAAP,EAAY;;;;;IAmBX,KAAA;;QACD,IAAMsD,YAAY,GAAGN,MAAM,CAACR,IAAP,CAAY,UAAAF,KAAA,EAAK;IAAI,MAAA,OAAAA,KAAA,CAAA;IAAK,KAA1B,CAArB,CAAA;QAEA,OAAOgB,YAAY,IAAI,IAAvB,CAAA;OAjCG,CAAA;;MAmCA,OAAAC,CAAAA,aAAA,GAAP,UACIpB,MADJ,EAEIqB,KAFJ,EAGIC,OAHJ,EAGkB;QAHlB,IA+BC7C,KAAA,GAAA,IA/BD,CAAA;;IAEI,IAAA,IAAA4C,KAAA,KAAA,KAAA,CAAA,EAAA;UAAAA,KAAA,GAA0B,IAAKE,CAAAA,cAAL,EAA1B,CAAA;IAA+C,KAAA;;IAC/C,IAAA,IAAAD,OAAA,KAAA,KAAA,CAAA,EAAA;IAAAA,MAAAA,OAAc,GAAA,IAAd,CAAA;IAAc,KAAA;;QAEd,IAAIE,SAAS,GAAsB,IAAnC,CAAA;IAEA,IAAA,IAAMhC,MAAM,GAAG6B,KAAK,CAAC7B,MAArB,CAAA;IAEA6B,IAAAA,KAAK,CAACnB,IAAN,CAAW,UAAAC,KAAA,EAAK;UACZ,IAAI,CAACmB,OAAD,IAAY9B,MAAM,KAAK,CAAvB,IAA4Be,OAAO,CAACJ,KAAD,CAAvC,EAAgD;YAC5CqB,SAAS,GAAG/C,KAAI,CAAC2C,aAAL,CAAmBpB,MAAnB,EAA2BG,KAA3B,CAAZ,CAAA;IACA,QAAA,OAAOqB,SAAP,CAAA;IACH,OAAA;;IAGD,MAAA,IAAMC,cAAc,GAAGhD,KAAI,CAAC6B,cAAL,CAAoBH,KAApB,CAAvB,CAAA;;UAEA,IAAI,CAACsB,cAAL,EAAqB;IACjB,QAAA,OAAA;IACH,OAAA;;UAED,IAAI,KAAA,IAASA,cAAb,EAA6B;YACzB,IAAIA,cAAc,CAACzC,GAAf,CAAmBe,GAAnB,CAAuBC,MAAvB,CAAJ,EAAoC;IAChCwB,UAAAA,SAAS,GAAGC,cAAZ,CAAA;IACA,UAAA,OAAO,IAAP,CAAA;IACH,SAAA;IACJ,OAAA;SAlBL,CAAA,CAAA;IAqBA,IAAA,OAAOD,SAAP,CAAA;OA9BG,CAAA;;MAgCA,OAAAE,CAAAA,kBAAA,GAAP,UACI1B,MADJ,EAEI2B,QAFJ,EAGIN,KAHJ,EAGmD;IAA/C,IAAA,IAAAA,KAAA,KAAA,KAAA,CAAA,EAAA;UAAAA,KAAA,GAA0B,IAAKE,CAAAA,cAAL,EAA1B,CAAA;IAA+C,KAAA;IAG/C;;;QACA,IAAMC,SAAS,GAAG,IAAA,CAAKJ,aAAL,CAAmBpB,MAAnB,EAA2BqB,KAA3B,EAAkC,IAAlC,CAAlB,CAAA;;QAEA,IAAI,CAACG,SAAL,EAAgB;IACZ,MAAA,OAAO,IAAP,CAAA;IACH,KAAA;;QAED,IAAIA,SAAS,CAACtC,OAAV,CAAkByC,QAAlB,EAA4B,CAAC,CAA7B,CAAJ,EAAqC;IACjC,MAAA,OAAOH,SAAP,CAAA;IACH,KAAA;;IACD,IAAA,OAAO,IAAP,CAAA;OAhBG,CAAA;IAkBP;;IAEG;;;IACI,EAAA,OAAA,CAAAI,aAAA,GAAP,UACI5B,MADJ,EAEIqB,KAFJ,EAE0C;QAF1C,IAuBC5C,KAAA,GAAA,IAvBD,CAAA;;QAII,IAAIgD,cAAc,GAAsB,IAAxC,CAAA;QAEA,IAAMI,aAAa,GAAGR,KAAK,CAACxB,MAAN,CAAa,UAAAC,OAAA,EAAO;IAAI,MAAA,OAAArB,KAAI,CAACsB,GAAL,CAASD,OAAT,CAAA,CAAA;IAAiB,KAAzC,CAAtB,CAAA;;IAEA,IAAA,IAAI,CAAC+B,aAAa,CAACrC,MAAnB,EAA2B;IACvB,MAAA,OAAO,IAAP,CAAA;IACH,KAAA;;IAED,IAAA,IAAA,CAAKhB,KAAL,CAAW0B,IAAX,CAAgB,UAAAsB,SAAA,EAAS;IACrB,MAAA,IAAIA,SAAS,CAAC5D,IAAV,KAAmB,QAAnB,IAA+B4D,SAAS,CAACzB,GAAV,CAAcC,MAAd,CAAnC,EAA0D;YACtDyB,cAAc,GAAGD,SAAS,CAACI,aAAV,CAAwB5B,MAAxB,EAAgC6B,aAAhC,CAAjB,CAAA;;IAEA,QAAA,IAAIJ,cAAJ,EAAoB;IAChB,UAAA,OAAO,IAAP,CAAA;IACH,SAAA;IACJ,OAAA;SAPL,CAAA,CAAA;IAUA,IAAA,OAAOA,cAAP,CAAA;OAtBG,CAAA;;IAwBA,EAAA,OAAA,CAAAK,iBAAA,GAAP,UACI9B,MADJ,EAEIqB,KAFJ,EAE0C;IAEtC,IAAA,IAAMG,SAAS,GAAG,IAAA,CAAKJ,aAAL,CAAmBpB,MAAnB,CAAlB,CAAA;;IAEA,IAAA,IAAIwB,SAAJ,EAAe;IACX,MAAA,OAAOA,SAAS,CAACI,aAAV,CAAwB5B,MAAxB,EAAgCqB,KAAhC,CAAP,CAAA;IACH,KAAA;;IACD,IAAA,OAAO,IAAP,CAAA;OATG,CAAA;;MAWA,OAAAU,CAAAA,cAAA,GAAP,YAAA;;;QACI,IAAMhD,YAAY,GAAG,IAAA,CAAKA,YAA1B,CAAA;;IAEA,IAAA,IAAIA,YAAJ,EAAkB;UACd,IAAMiD,WAAW,GAAG,CAAAC,EAAA,GAAA,IAAKtE,CAAAA,MAAL,MAAW,IAAX,IAAWsE,EAAA,KAAA,KAAA,CAAX,GAAW,KAAA,CAAX,GAAWA,EAAA,CAAEzD,KAAF,CAAQ6B,IAAR,CAAa,UAAA6B,CAAA,EAAC;IAAI,QAAA,OAAAA,CAAC,CAAC1D,KAAF,KAAYO,YAAZ,CAAA;IAAwB,OAA1C,CAA/B,CAAA;;IAEA,MAAA,IAAIiD,WAAJ,EAAiB;IACb,QAAA,OAAOA,WAAP,CAAA;IACH,OAAA;IACJ,KAAA;;IACD,IAAA,OAAO,IAAP,CAAA;OAVG,CAAA;;MAYA,OAAAT,CAAAA,cAAA,GAAP,YAAA;IACI,IAAA,OAAO,KAAK/C,KAAL,CAAWQ,GAAX,CAAe,UAAAmB,KAAA,EAAK;IACvB,MAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,QAAnB,EAA6B;YACzB,OAAOuC,KAAK,CAAC3B,KAAb,CAAA;IACH,OAFD,MAEO;YACH,OAAO2B,KAAK,CAACoB,cAAN,EAAP,CAAA;IACH,OAAA;IACJ,KANM,CAAP,CAAA;OADG,CAAA;;IASA,EAAA,OAAA,CAAcY,cAAd,GAAP,UAAsBxB,OAAtB,EAA+C;QAEvC,IAAAnC,KAAK,GACL,IAAA,CAAIA,KADJ,CAAA;QAGJ,IAAI4D,MAAM,GAAG,KAAb,CAAA;;IAEA,IAAA,IAAI,IAAKxE,CAAAA,IAAL,KAAc,MAAlB,EAA0B;IACtBwE,MAAAA,MAAM,GAAG5D,KAAK,CAAC0C,KAAN,CAAY,UAAAf,KAAA,EAAK;IACtB,QAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,QAAnB,EAA8B;IAC1B,UAAA,OAAO+C,OAAO,CAACT,IAAR,CAAa,UAAAF,MAAA,EAAU;IAAA,YAAA,OAAAG,KAAK,CAAC3B,KAAN,KAAgBwB,MAAhB,CAAA;IAAsB,WAA7C,CAAP,CAAA;IACH,SAFD,MAEO;IACH,UAAA,OAAOW,OAAO,CAACT,IAAR,CAAa,UAAAF,MAAA,EAAM;gBACtB,OAAOO,OAAO,CAACP,MAAD,CAAP,IAAmBG,KAAK,CAACgC,cAAN,CAAqBnC,MAArB,CAA1B,CAAA;IACH,WAFM,CAAP,CAAA;IAGH,SAAA;WAPI,CAAT,CADsB;IAWtB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACH,KAAA;;QAED,IAAIoC,MAAM,IAAIzB,OAAO,CAACnB,MAAR,KAAmBhB,KAAK,CAACgB,MAAvC,EAA+C;IAC3C,MAAA,OAAO,IAAP,CAAA;IACH,KAFD,MAEO;UACH,IAAI6C,aAAW,GAAsB,IAArC,CAAA;IAEA7D,MAAAA,KAAK,CAAC0B,IAAN,CAAW,UAAAC,KAAA,EAAK;IACZ,QAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,OAAnB,EAA4B;IACxByE,UAAAA,aAAW,GAAGlC,KAAK,CAACgC,cAAN,CAAqBxB,OAArB,CAAd,CAAA;IAEA,UAAA,OAAO0B,aAAP,CAAA;IACH,SAAA;WALL,CAAA,CAAA;IAQA,MAAA,OAAOA,aAAP,CAAA;IACH,KAAA;OA1CE,CAAA;;IA4CA,EAAA,OAAA,CAAcC,cAAd,GAAP,UAAsBX,QAAtB,EAA+D;IAC3D,IAAA,OAAO,KAAKnD,KAAL,CAAWqB,MAAX,CAAkB,UAAAM,KAAA,EAAK;IAC1B,MAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,QAAnB,EAA6B;YACzB,OAAOuC,KAAK,CAACjB,OAAN,CAAcyC,QAAd,EAAwB,CAAC,CAAzB,CAAP,CAAA;IACH,OAAA;;UACD,OAAOA,QAAQ,CAACY,OAAT,CAAiBpC,KAAK,CAAC3B,KAAvB,CAAgC,GAAA,CAAC,CAAxC,CAAA;IACH,KALM,CAKJQ,CAAAA,GALI,CAKA,UAAAmB,KAAA,EAAK;IACR,MAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,QAAnB,EAA6B;IACzB,QAAA,IAAMoE,WAAW,GAAG7B,KAAK,CAAC4B,cAAN,EAApB,CAAA;;IAEA,QAAA,IAAIC,WAAJ,EAAiB;IACb,UAAA,OAAOA,WAAP,CAAA;IACH,SAAA;IACJ,OAAA;;IACD,MAAA,OAAO7B,KAAP,CAAA;IACH,KAdM,CAAP,CAAA;OADG,CAAA;;IAiBA,EAAA,OAAA,CAAGqC,GAAH,GAAP,UAAW7B,OAAX,EAAsC;QAAtC,IA+DClC,KAAA,GAAA,IA/DD,CAAA;;QACU,IAAAwD,EAAA,GAGF,IAHE;IAAA,QACFzD,KAAK,WADH;IAAA,QAEFQ,GAAG,SAFD,CAAA;;IAKN2B,IAAAA,OAAO,CAACG,OAAR,CAAgB,UAAAX,KAAA,EAAK;UACjB,IAAI,SAAA,IAAaA,KAAjB,EAAwB;IACpB,QAAA,IAAMsC,KAAK,GAAG,IAAI7D,UAAJ,CAAeH,KAAf,CAAd,CAAA;IAEAgE,QAAAA,KAAK,CAACrE,EAAN,GAAW+B,KAAK,CAACuC,OAAjB,CAAA;YACAlE,KAAK,CAACmE,IAAN,CAAWF,KAAX,CAAA,CAAA;IACAA,QAAAA,KAAK,CAACD,GAAN,CAAUrC,KAAK,CAACyC,QAAhB,CAAA,CAAA;IACH,OAND,MAMO,IAAIrC,OAAO,CAACJ,KAAD,CAAX,EAAoB;IACvB,QAAA,IAAMsC,KAAK,GAAG,IAAI7D,UAAJ,CAAeH,KAAf,CAAd,CAAA;YAEAD,KAAK,CAACmE,IAAN,CAAWF,KAAX,CAAA,CAAA;YACAA,KAAK,CAACD,GAAN,CAAUrC,KAAV,CAAA,CAAA;IACH,OALM,MAKA;YACH,IAAML,OAAO,GAAG,SAAaK,IAAAA,KAAb,GAAqBA,KAAK,CAAC0C,OAA3B,GAAqC1C,KAArD,CAAA;YACA,IAAMM,MAAM,GAAG,IAAIpC,WAAJ,CAAgBI,KAAhB,EAAsBqB,OAAtB,CAAf,CAAA;YAEAtB,KAAK,CAACmE,IAAN,CAAWlC,MAAX,CAAA,CAAA;IACAzB,QAAAA,GAAG,CAAC8D,GAAJ,CAAQhD,OAAR,EAAkBW,MAAlB,CAAA,CAAA;IACH,OAAA;SAlBL,CAAA,CAAA;IAqBAjC,IAAAA,KAAK,CAACsC,OAAN,CAAc,UAAAX,KAAA,EAAK;IACf,MAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,QAAnB,EAA6B;IACzBoB,QAAAA,GAAG,CAAC8D,GAAJ,CAAQ3C,KAAK,CAAC3B,KAAd,EAAqB2B,KAArB,CAAA,CAAA;IACH,OAFD,MAEO;YACHA,KAAK,CAACnB,GAAN,CAAU8B,OAAV,CAAkB,UAACU,SAAD,EAAY1B,OAAZ,EAAmB;IACjCd,UAAAA,GAAG,CAAC8D,GAAJ,CAAQhD,OAAR,EAAiB0B,SAAjB,CAAA,CAAA;aADJ,CAAA,CAAA;IAGH,OAAA;SAPL,CAAA,CAAA;IAUAhD,IAAAA,KAAK,CAACsC,OAAN,CAAc,UAAAX,KAAA,EAAK;IACf,MAAA,IAAKA,KAAK,CAACvC,IAAN,KAAe,QAApB,EAA8B;IAC1B,QAAA,OAAA;IACH,OAHc;;;IAKf,MAAA,IAAMmF,aAAa,GAAG5C,KAAK,CAAC3B,KAA5B,CAAA;UACA,IAAMwE,UAAU,GAAGxE,KAAK,CAAC6B,IAAN,CAAW,UAAA4C,MAAA,EAAM;IAChC,QAAA,IAAIA,MAAM,CAACrF,IAAP,KAAgB,QAApB,EAA8B;IAC1B,UAAA,OAAA;IACH,SAAA;;IACD,QAAA,IAAMsF,YAAY,GAAGhF,aAAI,CAAA,EAAA,EAAA+E,MAAM,CAACjE,GAAP,CAAWmE,IAAX,EAAA,EAAiB,IAAjB,CAAJ,CAAuB,CAAvB,CAArB,CAAA;;YAEA,IAAI,CAACD,YAAL,EAAmB;IACf,UAAA,OAAA;IACH,SAAA;;IAED,QAAA,OAAOH,aAAa,CAAC9C,QAAd,CAAuBiD,YAAvB,CAAP,CAAA;IACH,OAXkB,CAAnB,CAAA;IAaC/C,MAAAA,KAAqB,CAACxB,cAAtB,GAAuC,CAAC,CAACqE,UAAzC,CAAA;;IAED,MAAA,IAAIA,UAAJ,EAAgB;IACXA,QAAAA,UAAyB,CAACjE,YAA1B,GAAyCoB,KAAK,CAAC3B,KAA/C,CAAA;IACJ,OAAA;SAvBL,CAAA,CAAA;IAyBA,IAAA,OAAOb,MAAP,CAAA;OA9DG,CAAA;;IAgEX,EAAA,OAACiB,UAAD,CAAA;IA1VA,CAAA,CAAgClB,KAAhC,CAAA;;IC1BM,SAAU0F,YAAV,CAAuBC,GAAvB,EAAwC;MAC1C,SAAS1C,OAAT,CAAiBE,MAAjB,EAA0C;IAAzB,IAAA,IAAAA,MAAA,KAAA,KAAA,CAAA,EAAA;IAAAA,MAAAA,MAAyB,GAAA,EAAzB,CAAA;IAAyB,KAAA;;QACtC,IAAMyC,GAAG,GAAqB,EAA9B,CAAA;IAEAzC,IAAAA,MAAM,CAACC,OAAP,CAAe,UAACX,KAAD,EAAM;IACjB,MAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,QAAnB,EAA6B;IACzB0F,QAAAA,GAAG,CAACX,IAAJ,CAASxC,KAAK,CAAC3B,KAAf,CAAA,CAAA;IACH,OAFD,MAEO;YACH8E,GAAG,CAACX,IAAJ,CAAShC,OAAO,CAACR,KAAK,CAAC3B,KAAP,CAAhB,CAAA,CAAA;IACH,OAAA;SALL,CAAA,CAAA;IAQA,IAAA,OAAO8E,GAAP,CAAA;IACH,GAAA;;MAED,OAAO;IACHD,IAAAA,GAAG,EAAE,YAAA;IAAM,MAAA,OAAAA,GAAA,CAAA;SADR;IAEH1C,IAAAA,OAAO,EAAA,YAAA;IACH,MAAA,OAAOA,OAAO,CAAC,IAAK0C,CAAAA,GAAL,EAAD,CAAd,CAAA;SAHD;IAKHE,IAAAA,OAAO,EAAA,YAAA;IACH,MAAA,OAAOjE,QAAQ,CAAC,IAAKqB,CAAAA,OAAL,EAAD,CAAf,CAAA;IACH,KAAA;OAPL,CAAA;IASH,CAAA;;IAED,IAAA6C,YAAA;IAAA;IAAA,UAAAlF,MAAA,EAAA;IAAkCC,EAAAA,SAAU,CAAAiF,YAAA,EAAAlF,MAAA,CAAV,CAAA;;IAI9B,EAAA,SACIkF,YADJ,CACIC,YADJ,EAEI9C,OAFJ,EAE6C;QAF7C,IAAAlC,KAAA,GAIIH,WAAA,KAAA,KAEH,IAND,CAAA;;QAHOG,KAAI,CAAAb,IAAJ,GAAO,MAAP,CAAA;QACCa,KAAQ,CAAAiF,QAAR,GAA6C,EAA7C,CAAA;;IAOJjF,IAAAA,KAAI,CAACqE,GAAL,CAASW,YAAT,EAAuB9C,OAAvB,CAAA,CAAA;;;IACH,GAAA;;IAVL,EAAA,IAAA,OAAA,GAAA,YAAA,CAAA,SAAA,CAAA;;IAWW,EAAA,OAAA,CAAAmC,GAAA,GAAP,UACIW,YADJ,EAEI9C,OAFJ,EAEiD;QAFjD,IAsBClC,KAAA,GAAA,IAtBD,CAAA;;IAEI,IAAA,IAAAkC,OAAA,KAAA,KAAA,CAAA,EAAA;IAAAA,MAAAA,OAA6C,GAAA,EAA7C,CAAA;IAA6C,KAAA;;IAE7C,IAAA,IAAA,CAAK3B,GAAL,GAAW,IAAIC,GAAJ,EAAX,CAAA;QACA,IAAKT,CAAAA,KAAL,GAAa,EAAb,CAAA;QAEA,IAAMQ,GAAG,GAAG,IAAA,CAAKA,GAAjB,CAAA;QACA,IAAMR,KAAK,GAAG,IAAA,CAAKA,KAAnB,CAAA;QAEA,IAAKgE,CAAAA,GAAL,CAASiB,YAAT,CAAA,CAAA;IACA9C,IAAAA,OAAO,CAACG,OAAR,CAAgB,UAAAd,MAAA,EAAM;IAClB,MAAA,IAAIhB,GAAG,CAACe,GAAJ,CAAQC,MAAR,CAAJ,EAAqB;IACjB,QAAA,OAAA;IACH,OAAA;;UACD,IAAMS,MAAM,GAAG,IAAIpC,WAAJ,CAAgBI,KAAhB,EAAsBuB,MAAtB,CAAf,CAAA;UAEAS,MAAM,CAAC5C,KAAP,GAAe,CAAf,CAAA;UACAW,KAAK,CAACmE,IAAN,CAAWlC,MAAX,CAAA,CAAA;IACAzB,MAAAA,GAAG,CAAC8D,GAAJ,CAAQ9C,MAAR,EAAgBS,MAAhB,CAAA,CAAA;SARJ,CAAA,CAAA;QAUA,IAAKiD,CAAAA,QAAL,GAAgB/C,OAAhB,CAAA;OArBG,CAAA;;IAuBA,EAAA,OAAA,CAAAgD,eAAA,GAAP,UAAuBhD,OAAvB,EAAkDX,MAAlD,EAAkF;QAC9E,IAAM4D,IAAI,GAAG,IAAb,CAAA;QACA,IAAMpC,SAAS,GAAGoC,IAAI,CAACxC,aAAL,CAAmBpB,MAAnB,EAA2BW,OAA3B,EAAoC,KAApC,CAAlB,CAAA;QACA,IAAMkD,WAAW,GAAGD,IAAI,CAAC5E,GAAL,CAASf,GAAT,CAAa+B,MAAb,CAApB,CAAA;QAEA,IAAI8D,UAAU,GAAiB,EAA/B,CAAA;;IAEA,IAAA,IAAItC,SAAJ,EAAe;UACXsC,UAAU,GAAG,CAACtC,SAAD,CAAb,CAAA;SADJ,MAEO,IAAIqC,WAAJ,EAAiB;UACpBC,UAAU,GAAG,CAACD,WAAD,CAAb,CAAA;IACH,KAFM,MAEA;IACHC,MAAAA,UAAU,GAAG,EAAb,CAAA;IACH,KAAA;;QAED,OAAOV,YAAY,CAACU,UAAD,CAAnB,CAAA;OAfG,CAAA;;MAiBA,OAAAC,CAAAA,kBAAA,GAAP,UACIpD,OADJ,EAEIqD,KAFJ,EAGIC,OAHJ,EAG4C;QAExC,IAAMC,WAAW,GAAAhG,aAAA,CAAA,EAAA,EAAOyC,OAAP,EAAc,IAAd,CAAjB,CAFwC;;;IAKxCsD,IAAAA,OAAO,CAACnD,OAAR,CAAgB,UAAAhB,OAAA,EAAO;IACnB,MAAA,IAAMqE,KAAK,GAAGD,WAAW,CAAC3B,OAAZ,CAAoBzC,OAApB,CAAd,CAAA;;IAEA,MAAA,IAAIqE,KAAK,GAAG,CAAC,CAAb,EAAgB;IACZD,QAAAA,WAAW,CAACE,MAAZ,CAAmBD,KAAnB,EAA0B,CAA1B,CAAA,CAAA;IACH,OAAA;IACJ,KAND,EALwC;;IAcxCH,IAAAA,KAAK,CAAClD,OAAN,CAAc,UAAAhB,OAAA,EAAO;UACjBoE,WAAW,CAACvB,IAAZ,CAAiB7C,OAAjB,CAAA,CAAA;SADJ,CAAA,CAAA;IAIA,IAAA,OAAOsD,YAAY,CAAC,IAAA,CAAKiB,QAAL,CAAcH,WAAd,CAAD,CAAnB,CAAA;OArBG,CAAA;;MAuBA,OAAqBI,CAAAA,qBAArB,GAAP,UACI3D,OADJ,EAEIqD,KAFJ,EAGIC,OAHJ,EAIIM,cAJJ,EAI4B;QAJ5B,IAsDC9F,KAAA,GAAA,IAtDD,CAAA;;QAMI,IAAMyF,WAAW,GAAAhG,aAAA,CAAA,EAAA,EAAOyC,OAAP,EAAc,IAAd,CAAjB,CAAA;;IACA,IAAA,IAAM6D,aAAa,GAAGlF,QAAQ,CAAC4E,WAAD,CAA9B,CAHwB;;IAMxBD,IAAAA,OAAO,CAACnD,OAAR,CAAgB,UAAAhB,OAAA,EAAO;IACnB;IACA,MAAA,IAAMqE,KAAK,GAAGD,WAAW,CAAC3B,OAAZ,CAAoBzC,OAApB,CAAd,CAAA;;IAEA,MAAA,IAAIqE,KAAK,GAAG,CAAC,CAAb,EAAgB;IACZ;IACAD,QAAAA,WAAW,CAACE,MAAZ,CAAmBD,KAAnB,EAA0B,CAA1B,CAAA,CAAA;IACA,QAAA,OAAA;IACH,OARkB;;;UAUnB,IAAMM,YAAY,GAAGF,cAAc;YAE7B9F,KAAI,CAAC2C,aAAL,CAAmBtB,OAAnB,EAA4BoE,WAA5B,CAF6B;YAI7BzF,KAAI,CAACiD,kBAAL,CAAwB5B,OAAxB,EAAiCmE,OAAjC,EAA0CC,WAA1C,CAJN,CAAA;;IAMA,MAAA,IAAIO,YAAJ,EAAkB;YACd,IAAMC,UAAU,GAAGR,WAAW,CAACS,SAAZ,CAAsB,UAAA3E,MAAA,EAAM;cAC3C,OAAOO,OAAO,CAACP,MAAD,CAAP,IAAmByE,YAAY,CAACvF,OAAb,CAAqBc,MAArB,CAA1B,CAAA;IACH,SAFkB,CAAnB,CAAA;;IAIA,QAAA,IAAI0E,UAAU,GAAG,CAAC,CAAlB,EAAqB;IACjBR,UAAAA,WAAW,CAACE,MAAZ,CAAmBM,UAAnB,EAA+B,CAA/B,CAAA,CAAA;IACH,SAAA;IACJ,OAAA;SAxBL,CAAA,CAAA;IA2BAV,IAAAA,KAAK,CAAClD,OAAN,CAAc,UAAAhB,OAAA,EAAO;UACjB,IAAM8E,WAAW,GAAGnG,KAAI,CAACoG,gBAAL,CAAsB/E,OAAtB,EAA+B0E,aAA/B,CAApB,CAAA;;IACA,MAAA,IAAMhD,SAAS,GAAGoD,WAAW,CAACxE,kBAAZ,CAA+BN,OAA/B,CAAlB,CAAA;;IAEA,MAAA,IAAI,CAAA0B,SAAS,KAAA,IAAT,IAAAA,SAAS,KAAA,KAAA,CAAT,GAAS,KAAA,CAAT,GAAAA,SAAS,CAAE5D,IAAX,MAAoB,OAAxB,EAAiC;IAC7B,QAAA,IAAMoE,WAAW,GAAGR,SAAS,CAACO,cAAV,EAApB,CAAA;;IAEA,QAAA,IAAIC,WAAJ,EAAiB;IACbkC,UAAAA,WAAW,CAACvB,IAAZ,CAAiBX,WAAW,CAACxD,KAA7B,CAAA,CAAA;IACH,SAFD,MAEO;IACH0F,UAAAA,WAAW,CAACvB,IAAZ,CAAiBnB,SAAS,CAACD,cAAV,EAAjB,CAAA,CAAA;IACH,SAAA;;IACD,QAAA,OAAA;IACH,OAAA;;UACD2C,WAAW,CAACvB,IAAZ,CAAiB7C,OAAjB,CAAA,CAAA;SAdJ,CAAA,CAAA;IAgBA,IAAA,OAAOsD,YAAY,CAAC,IAAA,CAAKiB,QAAL,CAAcH,WAAd,CAAD,CAAnB,CAAA;OArDG,CAAA;;MAuDA,OAAqBY,CAAAA,qBAArB,GAAP,UACInE,OADJ,EAEIqD,KAFJ,EAGIC,OAHJ,EAIIM,cAJJ,EAI4B;QAExB,IAAML,WAAW,GAAAhG,aAAA,CAAA,EAAA,EAAOyC,OAAP,EAAc,IAAd,CAAjB,CAAA;;IACA,IAAA,IAAMQ,YAAY,GAAG,IAAA,CAAKT,gBAAL,CAAsBwD,WAAtB,CAArB,CAAA;IAEAD,IAAAA,OAAO,CAACnD,OAAR,CAAgB,UAAAhB,OAAA,EAAO;IACnB;IACA,MAAA,IAAMqE,KAAK,GAAGD,WAAW,CAAC3B,OAAZ,CAAoBzC,OAApB,CAAd,CAAA;;IAEA,MAAA,IAAIqE,KAAK,GAAG,CAAC,CAAb,EAAgB;IACZ;IACAD,QAAAA,WAAW,CAACE,MAAZ,CAAmBD,KAAnB,EAA0B,CAA1B,CAAA,CAAA;IACA,QAAA,OAAA;IACH,OAAA;;UACD,IAAMM,YAAY,GAAGF,cAAc;YAE7BpD,YAAY,CAACO,kBAAb,CAAgC5B,OAAhC,EAAyCmE,OAAzC,EAAkDC,WAAlD,CAF6B;YAI7B/C,YAAY,CAACC,aAAb,CAA2BtB,OAA3B,EAAoCoE,WAApC,EAAiD,IAAjD,CAJN,CAAA;;IAMA,MAAA,IAAIO,YAAJ,EAAkB;YACd,IAAMC,UAAU,GAAGR,WAAW,CAACS,SAAZ,CAAsB,UAAA3E,MAAA,EAAM;cAC3C,OAAOO,OAAO,CAACP,MAAD,CAAP,IAAmByE,YAAY,CAACvF,OAAb,CAAqBc,MAArB,CAA1B,CAAA;IACH,SAFkB,CAAnB,CAAA;;IAIA,QAAA,IAAI0E,UAAU,GAAG,CAAC,CAAlB,EAAqB;IACjBR,UAAAA,WAAW,CAACE,MAAZ,CAAmBM,UAAnB,EAA+B,CAA/B,CAAA,CAAA;IACH,SAAA;IACJ,OAAA;SAvBL,CAAA,CAAA;IAyBA,IAAA,IAAMK,aAAa,GAAG5D,YAAY,CAACmB,cAAb,CAA4B0B,KAA5B,CAAtB,CAAA;IAEAe,IAAAA,aAAa,CAACjE,OAAd,CAAsB,UAAAX,KAAA,EAAK;IACvB,MAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,QAAnB,EAA6B;IACzBsG,QAAAA,WAAW,CAACvB,IAAZ,CAAiBxC,KAAK,CAAC3B,KAAvB,CAAA,CAAA;IACH,OAFD,MAEO;YACH,IAAMkG,UAAU,GAAGR,WAAW,CAACS,SAAZ,CAAsB,UAAA3E,MAAA,EAAM;IAC3C,UAAA,OAAOO,OAAO,CAACP,MAAD,CAAP,IAAmBG,KAAK,CAACjB,OAAN,CAAcc,MAAd,EAAsB,CAAtB,CAA1B,CAAA;IACH,SAFkB,CAAnB,CAAA;;IAIA,QAAA,IAAI0E,UAAU,GAAG,CAAC,CAAlB,EAAqB;IACjBR,UAAAA,WAAW,CAACE,MAAZ,CAAmBM,UAAnB,EAA+B,CAA/B,CAAA,CAAA;IACH,SAAA;;IACDR,QAAAA,WAAW,CAACvB,IAAZ,CAAiBxC,KAAK,CAACoB,cAAN,EAAjB,CAAA,CAAA;IACH,OAAA;SAZL,CAAA,CAAA;IAcA,IAAA,OAAO6B,YAAY,CAAC,IAAA,CAAKiB,QAAL,CAAcH,WAAd,CAAD,CAAnB,CAAA;OAlDG,CAAA;;IAoDA,EAAA,OAAA,CAAQG,QAAR,GAAP,UAAgB1D,OAAhB,EAAyC;QAAzC,IA2BClC,KAAA,GAAA,IA3BD,CAAA;;QACI,IAAMoC,MAAM,GAAiB,EAA7B,CAAA;IAEAF,IAAAA,OAAO,CAACG,OAAR,CAAgB,UAAAd,MAAA,EAAM;IAClB,MAAA,IAAIO,OAAO,CAACP,MAAD,CAAX,EAAqB;IACjB,QAAA,IAAMgF,UAAU,GAAGvG,KAAI,CAAC0D,cAAL,CAAoBnC,MAApB,CAAnB,CAAA;;IAEA,QAAA,IAAIgF,UAAJ,EAAgB;IACZ,UAAA,IAAMhD,WAAW,GAAGgD,UAAU,CAACjD,cAAX,EAApB,CAAA;;IAEA,UAAA,IAAIC,WAAJ,EAAiB;IACb,YAAA,OAAOA,WAAP,CAAA;IACH,WAAA;;cACDnB,MAAM,CAAC8B,IAAP,CAAYqC,UAAZ,CAAA,CAAA;IACH,SAAA;IACJ,OAXD,MAWO;YACH,IAAMvE,MAAM,GAAGhC,KAAI,CAACO,GAAL,CAASf,GAAT,CAAa+B,MAAb,CAAf,CAAA;;IAEA,QAAA,IAAIS,MAAJ,EAAY;cACRI,MAAM,CAAC8B,IAAP,CAAYlC,MAAZ,CAAA,CAAA;IACH,SAFD,MAEO;cACHI,MAAM,CAAC8B,IAAP,CAAY,IAAItE,WAAJ,CAAgBI,KAAhB,EAAsBuB,MAAtB,CAAZ,CAAA,CAAA;IACH,SAAA;IACJ,OAAA;SApBL,CAAA,CAAA;IAuBA,IAAA,OAAOa,MAAP,CAAA;OA1BG,CAAA;;IAiCA,EAAA,OAAA,CAAAoE,SAAA,GAAP,UACInF,OADJ,EAEIoF,MAFJ,EAEoB;QAEhB,IAAM1G,KAAK,GAAG,IAAKQ,CAAAA,GAAL,CAASf,GAAT,CAAa6B,OAAb,CAAd,CAAA;;IAEA,IAAA,IAAIoF,MAAJ,EAAY;UACR,OAAO1G,KAAK,IAAI,IAAIH,WAAJ,CAAgB,IAAhB,EAAsByB,OAAtB,CAAhB,CAAA;IACH,KAAA;;IACD,IAAA,OAAOtB,KAAP,CAAA;OATG,CAAA;;IAWA,EAAA,OAAA,CAAkB2G,kBAAlB,GAAP,UAA0B/G,EAA1B,EAAoC;QAChC,IAAII,KAAK,GAAsB,IAA/B,CAAA;QAEA,IAAKA,CAAAA,KAAL,CAAW0B,IAAX,CAAgB,SAASG,IAAT,CAAcF,KAAd,EAA+B;IAC3C,MAAA,IAAIA,KAAK,CAACvC,IAAN,KAAe,QAAnB,EAA6B;IACzB,QAAA,IAAIuC,KAAK,CAAC/B,EAAN,KAAaA,EAAjB,EAAqB;IACjBI,UAAAA,KAAK,GAAG2B,KAAR,CAAA;IACA,UAAA,OAAO,IAAP,CAAA;IACH,SAHD,MAGO;IACH,UAAA,OAAOA,KAAK,CAAC3B,KAAN,CAAY0B,IAAZ,CAAiBG,IAAjB,CAAP,CAAA;IACH,SAAA;IACJ,OAAA;SARL,CAAA,CAAA;IAWA,IAAA,OAAO7B,KAAP,CAAA;OAdG,CAAA;;IAgBA,EAAA,OAAA,CAAAiE,KAAA,GAAP,UAAa9B,OAAb,EAAwC4C,OAAxC,EAAyD;QAAzD,IA0BC9E,KAAA,GAAA,IA1BD,CAAA;;IACI,IAAA,IAAM0C,YAAY,GAAG,IAAA,CAAKT,gBAAL,CAAsBC,OAAtB,CAArB,CAAA;QACA,IAAMyE,WAAW,GAAGzE,OAAO,CAAC3B,GAAR,CAAY,UAAAgB,MAAA,EAAM;IAClC,MAAA,IAAIO,OAAO,CAACP,MAAD,CAAX,EAAqB;IACjB,QAAA,OAAOvB,KAAI,CAAC0D,cAAL,CAAoBnC,MAApB,CAAP,CAAA;IACH,OAAA;;IACD,MAAA,OAAOvB,KAAI,CAACwG,SAAL,CAAejF,MAAf,CAAP,CAAA;IACH,KALmB,CAApB,CAAA;QAMA,IAAMqF,WAAW,GAAGD,WAAW,CAAClE,KAAZ,CAAkB,UAAAf,KAAA,EAAK;IAAI,MAAA,OAAA,CAAAA,KAAK,KAAL,IAAA,IAAAA,KAAK,KAAL,KAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,KAAK,CAAExC,MAAP,MAAkBwD,YAAlB,CAAA;IAA8B,KAAzD,CAApB,CAAA;;QAEA,IAAI,CAACkE,WAAL,EAAkB;IACd,MAAA,OAAO,IAAP,CAAA;IACH,KAAA;;IACD,IAAA,IAAM5C,KAAK,GAAG,IAAI7D,UAAJ,CAAeuC,YAAf,CAAd,CAAA;QACA,IAAM2C,UAAU,GAAG3C,YAAY,CAAC3C,KAAb,CAAmBqB,MAAnB,CAA0B,UAAAG,MAAA,EAAU;IAAA,MAAA,OAAAoF,WAAW,CAAC7C,OAAZ,CAAoBvC,MAApB,CAAA,KAAgC,CAAC,CAAjC,CAAA;IAAkC,KAAtE,CAAnB,CAAA;;IAEA,IAAA,IAAI,CAAC8D,UAAU,CAACtE,MAAhB,EAAwB;IACpB,MAAA,OAAO,IAAP,CAAA;IACH,KAAA;;QACDsE,UAAU,CAACwB,OAAX,CAAmB7C,KAAnB,CAAA,CAAA;QACAA,KAAK,CAACD,GAAN,CAAUe,OAAO,GAAGjE,QAAQ,CAACqB,OAAD,CAAX,GAAuBA,OAAxC,CAAA,CAAA;QACAQ,YAAY,CAAC3C,KAAb,GAAqBsF,UAArB,CAAA;IAEA,IAAA,IAAA,CAAKhB,GAAL,CAAS,IAAA,CAAKvB,cAAL,EAAT,EAAgC,KAAKmC,QAArC,CAAA,CAAA;QAEA,OAAOjB,KAAK,CAAClB,cAAN,EAAP,CAAA;OAzBG,CAAA;;IA2BA,EAAA,OAAA,CAAOgE,OAAP,GAAP,UAAe5E,OAAf,EAAwC;QAAxC,IAoCClC,KAAA,GAAA,IApCD,CAAA;;IACI,IAAA,IAAIkC,OAAO,CAACnB,MAAR,KAAmB,CAAnB,IAAwBe,OAAO,CAACI,OAAO,CAAC,CAAD,CAAR,CAAnC,EAAiD;IAC7CA,MAAAA,OAAO,GAAGA,OAAO,CAAC,CAAD,CAAjB,CAAA;IACH,KAAA;;IACD,IAAA,IAAMQ,YAAY,GAAG,IAAA,CAAKT,gBAAL,CAAsBC,OAAtB,CAArB,CAAA;QACA,IAAMyE,WAAW,GAAGzE,OAAO,CAAC3B,GAAR,CAAY,UAAAgB,MAAA,EAAM;IAClC,MAAA,IAAIO,OAAO,CAACP,MAAD,CAAX,EAAqB;IACjB,QAAA,OAAOvB,KAAI,CAAC0D,cAAL,CAAoBnC,MAApB,CAAP,CAAA;IACH,OAAA;;IACD,MAAA,OAAOvB,KAAI,CAACwG,SAAL,CAAejF,MAAf,CAAP,CAAA;IACH,KALmB,CAApB,CAAA;;QAOA,IAAImB,YAAY,CAACpC,YAAjB,EAA+B;IAC3B,MAAA,OAAO,IAAP,CAAA;IACH,KAdmC;;;QAiBpC,IAAMsG,WAAW,GAAGlE,YAAY,CAAC3C,KAAb,CAAmB0C,KAAnB,CAAyB,UAAAf,KAAA,EAAS;IAAA,MAAA,OAAAiF,WAAW,CAAC7C,OAAZ,CAAoBpC,KAApB,CAAA,GAA6B,CAAC,CAA9B,CAAA;IAA+B,KAAjE,CAApB,CAAA;;IAEA,IAAA,IAAI,CAACkF,WAAD,IAAgBlE,YAAY,KAAK,IAArC,EAA2C;IACvC;IACA,MAAA,OAAO,IAAP,CAAA;IACH,KAAA;;IAED,IAAA,IAAMxD,MAAM,GAAGwD,YAAY,CAACxD,MAA5B,CAAA;;QAEA,IAAI,CAACA,MAAL,EAAa;IACT,MAAA,OAAO,IAAP,CAAA;IACH,KAAA;;QACD,IAAMmG,UAAU,GAAGnG,MAAM,CAACa,KAAP,CAAaqB,MAAb,CAAoB,UAAAG,MAAA,EAAM;UAAI,OAAAA,MAAM,KAAKmB,YAAX,CAAA;IAAuB,KAArD,CAAnB,CAAA;QAEA2C,UAAU,CAACnB,IAAX,CAAA9D,KAAA,CAAAiF,UAAA,EAAmB3C,YAAY,CAAC3C,KAAhC,CAAA,CAAA;QACAb,MAAM,CAACa,KAAP,GAAesF,UAAf,CAAA;IAEA,IAAA,IAAA,CAAKhB,GAAL,CAAS,IAAA,CAAKvB,cAAL,EAAT,EAAgC,KAAKmC,QAArC,CAAA,CAAA;QACA,OAAOvC,YAAY,CAACI,cAAb,EAAP,CAAA;OAnCG,CAAA;;IAqCG,EAAA,OAAA,CAAAsD,gBAAA,GAAV,UACI/E,OADJ,EAEIuB,KAFJ,EAE0C;IAEtC,IAAA,IAAI,CAACA,KAAK,CAAC7B,MAAX,EAAmB;IACf,MAAA,OAAO,IAAP,CAAA;IACH,KAAA;;QACD,IAAMiB,MAAM,GAAG,IAAKzB,CAAAA,GAAL,CAASf,GAAT,CAAa6B,OAAb,CAAf,CAAA;;QAEA,IAAI,CAACW,MAAL,EAAa;IACT,MAAA,OAAO,IAAP,CAAA;IACH,KAAA;;IACD,IAAA,IAAI9C,MAAM,GAA2B8C,MAAM,CAAC9C,MAA5C,CAAA;;IAEA,IAAA,OAAOA,MAAP,EAAe;IACX,MAAA,IAAI0D,KAAK,CAACnB,IAAN,CAAW,UAAAJ,OAAA,EAAW;IAAA,QAAA,OAAAnC,MAAO,CAACsC,QAAR,CAAiBH,OAAjB,CAAA,CAAA;IAAyB,OAA/C,CAAJ,EAAsD;IAClD,QAAA,OAAOnC,MAAP,CAAA;IACH,OAAA;;UACDA,MAAM,GAAGA,MAAM,CAACA,MAAhB,CAAA;IACH,KAAA;;IACD,IAAA,OAAO,IAAP,CAAA;OApBM,CAAA;;IAsBd,EAAA,OAAC6F,YAAD,CAAA;IAvUA,CAAA,CAAkC5E,UAAlC,CAAA;;;;;;;;;;;;;;;;;"}