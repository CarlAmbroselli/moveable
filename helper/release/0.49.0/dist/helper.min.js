/*
Copyright (c) Daybrush
name: @moveable/helper
license: MIT
author: Daybrush
repository: https://github.com/daybrush/moveable/blob/master/packages/helper
version: 0.1.3
*/
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).MoveableHelper=n()}(this,function(){"use strict";var r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)};function i(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}function f(t,n,e){if(e||2===arguments.length)for(var r,i=0,u=n.length;i<u;i++)!r&&i in n||((r=r||Array.prototype.slice.call(n,0,i))[i]=n[i]);return t.concat(r||Array.prototype.slice.call(n))}function l(t){return Array.isArray(t)}function e(t,n,e){n=function(t,n,e){void 0===e&&(e=-1);for(var r=t.length,i=0;i<r;++i)if(n(t[i],i,t))return i;return e}(t,n);return-1<n?t[n]:e}function s(t){return t.reduce(function(t,n){return l(n)?t.push.apply(t,s(n)):t.push(n),t},[])}var t=function(){function t(t){this.parent=t,this.type="single",this.depth=0,this._scope=[],t&&(this.depth=t.depth+1)}return Object.defineProperty(t.prototype,"scope",{get:function(){var t=this.parent;return t&&"root"!==t.type?f(f([],t.scope,!0),[t.id],!1):[]},enumerable:!1,configurable:!0}),t}(),o=function(e){function t(t,n){t=e.call(this,t)||this;return t.value=n,t.type="single",t.isGroupElement=!1,t}return i(t,e),t}(t),a=function(n){function u(){var t=null!==n&&n.apply(this,arguments)||this;return t.type="group",t.value=[],t.id="",t.groupElement=null,t.map=new Map,t}i(u,n);var t=u.prototype;return t.compare=function(t,n){void 0===n&&(n=0);var t=s(t),e=this.map,r=t.length,i=e.size,u=i-r,t=t.filter(function(t){return e.has(t)}).length;return 0<n&&0<=u||0===n&&0==u?r===t:n<0&&u<=0&&i===t},t.has=function(t){return this.map.has(t)},t.contains=function(n){return!!this.has(n)||this.value.some(function(t){return"group"===t.type&&t.contains(n)})},t.findContainedChild=function(n){return e(this.value,function(t){return"single"===t.type?t.value===n:t.contains(n)})},t.findExactChild=function(t){var n=this.map;if(!l(t))return n.get(t);var t=s(t),e=t.length,n=n.get(t[0]);if(n)for(var r=n.parent;r;){if(r.map.size>=e)return r;r=r.parent}},t.findCommonParent=function(t){for(var n=this,e=1/0,r=t.map(function(t){return n.findExactChild(t)}),i=(r.forEach(function(t){t&&(e=Math.min(t.depth,e))}),this);e;){var u=function(){--e;var n=(r=r.map(function(t){for(var n=t;n&&n.depth!==e;)n=n.parent;return n})).find(function(t){return t});return n?r.every(function(t){return!t||t===n})?"break":void 0:{value:i}}();if("object"==typeof u)return u.value;if("break"===u)break}return r.find(function(t){return t})||this},t.findNextChild=function(n,t,e){var r=this,i=(void 0===t&&(t=this.toTargetGroups()),void 0===e&&(e=!0),null),u=t.length;return t.some(function(t){return!e&&1===u&&l(t)?i=r.findNextChild(n,t):(t=r.findExactChild(t))&&"map"in t&&t.map.has(n)?(i=t,!0):void 0}),i},t.findNextExactChild=function(t,n,e){void 0===e&&(e=this.toTargetGroups());t=this.findNextChild(t,e,!0);return t&&t.compare(n,-1)?t:null},t.findPureChild=function(n,t){var e=this,r=null,i=t.filter(function(t){return e.has(t)});return i.length?(this.value.some(function(t){if("single"!==t.type&&t.has(n)&&(r=t.findPureChild(n,i)))return!0}),r):this},t.findNextPureChild=function(t,n){var e=this.findNextChild(t);return e?e.findPureChild(t,n):null},t.getSingleChild=function(){var n=this.groupElement;if(n){var t=null==(t=this.parent)?void 0:t.value.find(function(t){return t.value===n});if(t)return t}return null},t.toTargetGroups=function(){return this.value.map(function(t){return"single"===t.type?t.value:t.toTargetGroups()})},t.findArrayChild=function(e){var n,t=this.value,r=!1;return(r="root"!==this.type?t.every(function(n){return"single"===n.type?e.some(function(t){return n.value===t}):e.some(function(t){return l(t)&&n.findArrayChild(t)})}):r)&&e.length===t.length?this:(n=null,t.some(function(t){if("group"===t.type)return n=t.findArrayChild(e)}),n)},t.groupByPerfect=function(n){return this.value.filter(function(t){return"single"!==t.type?t.compare(n,-1):-1<n.indexOf(t.value)}).map(function(t){if("single"!==t.type){var n=t.getSingleChild();if(n)return n}return t})},t.add=function(t){var e=this,r=this.value,i=this.map;return t.forEach(function(t){var n;"groupId"in t?((n=new u(e)).id=t.groupId,r.push(n),n.add(t.children)):l(t)?(n=new u(e),r.push(n),n.add(t)):(n="current"in t?t.current:t,t=new o(e,n),r.push(t),i.set(n,t))}),r.forEach(function(t){"single"===t.type?i.set(t.value,t):t.map.forEach(function(t,n){i.set(n,t)})}),r.forEach(function(t){var n,e;"single"===t.type&&(n=t.value,e=r.find(function(t){if("single"!==t.type){t=f([],t.map.keys(),!0)[0];if(t)return n.contains(t)}}),t.isGroupElement=!!e,e)&&(e.groupElement=t.value)}),parent},u}(t);function h(t){return{raw:function(){return t},targets:function(){return function n(t){var e=[];return(t=void 0===t?[]:t).forEach(function(t){"single"===t.type?e.push(t.value):e.push(n(t.value))}),e}(this.raw())},flatten:function(){return s(this.targets())}}}return{__proto__:null,Child:t,SingleChild:o,ArrayChild:a,toTargetList:h,GroupManager:function(r){function t(t,n){var e=r.call(this)||this;return e.type="root",e._targets=[],e.set(t,n),e}i(t,r);var n=t.prototype;return n.set=function(t,n){var e=this,r=(void 0===n&&(n=[]),this.map=new Map,this.value=[],this.map),i=this.value;this.add(t),n.forEach(function(t){var n;r.has(t)||((n=new o(e,t)).depth=1,i.push(n),r.set(t,n))}),this._targets=n},n.selectSubChilds=function(t,n){t=this.findNextChild(n,t,!1),n=this.map.get(n);return h(t?[t]:n?[n]:[])},n.selectSingleChilds=function(t,n,e){var r=f([],t,!0);return e.forEach(function(t){t=r.indexOf(t);-1<t&&r.splice(t,1)}),n.forEach(function(t){r.push(t)}),h(this.toChilds(r))},n.selectCompletedChilds=function(t,n,r,i){var u=this,o=f([],t,!0),a=s(o);return r.forEach(function(t){var n,e=o.indexOf(t);(-1<e||(n=i?u.findNextChild(t,o):u.findNextExactChild(t,r,o))&&-1<(e=o.findIndex(function(t){return l(t)&&n.compare(t)})))&&o.splice(e,1)}),n.forEach(function(t){var n,e=u._findParentGroup(t,a).findContainedChild(t);"group"===(null==e?void 0:e.type)?(n=e.getSingleChild())?o.push(n.value):o.push(e.toTargetGroups()):o.push(t)}),h(this.toChilds(o))},n.selectSameDepthChilds=function(t,n,r,i){var u=f([],t,!0),o=this.findCommonParent(u);return r.forEach(function(t){var n,e=u.indexOf(t);(-1<e||(n=i?o.findNextExactChild(t,r,u):o.findNextChild(t,u,!0))&&-1<(e=u.findIndex(function(t){return l(t)&&n.compare(t)})))&&u.splice(e,1)}),o.groupByPerfect(n).forEach(function(n){var t;"single"===n.type?u.push(n.value):(-1<(t=u.findIndex(function(t){return l(t)&&n.compare(t,1)}))&&u.splice(t,1),u.push(n.toTargetGroups()))}),h(this.toChilds(u))},n.toChilds=function(t){var r=this,i=[];return t.forEach(function(t){if(l(t)){var n=r.findArrayChild(t);if(n){var e=n.getSingleChild();if(e)return e;i.push(n)}}else{e=r.map.get(t);i.push(e||new o(r,t))}}),i},n.findChild=function(t,n){var e=this.map.get(t);return n?e||new o(this,t):e},n.findArrayChildById=function(e){var r=null;return this.value.some(function t(n){if("single"!==n.type)return n.id===e?(r=n,!0):n.value.some(t)}),r},n.group=function(t,n){var e,r,i=this,u=this.findCommonParent(t),o=t.map(function(t){return l(t)?i.findArrayChild(t):i.findChild(t)});return o.every(function(t){return(null==t?void 0:t.parent)===u})&&(e=new a(u),(r=u.value.filter(function(t){return-1===o.indexOf(t)})).length)?(r.unshift(e),e.add(n?s(t):t),u.value=r,this.set(this.toTargetGroups(),this._targets),e.toTargetGroups()):null},n.ungroup=function(t){var n,e=this,r=(1===t.length&&l(t[0])&&(t=t[0]),this.findCommonParent(t)),i=t.map(function(t){return l(t)?e.findArrayChild(t):e.findChild(t)});return!r.groupElement&&r.value.every(function(t){return-1<i.indexOf(t)})&&r!==this&&(t=r.parent)?((n=t.value.filter(function(t){return t!==r})).push.apply(n,r.value),t.value=n,this.set(this.toTargetGroups(),this._targets),r.toTargetGroups()):null},n._findParentGroup=function(t,n){if(n.length){t=this.map.get(t);if(t)for(var e=t.parent;e;){if(n.some(function(t){return e.contains(t)}))return e;e=e.parent}}return this},t}(a)}});
//# sourceMappingURL=helper.min.js.map
